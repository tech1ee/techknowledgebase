---
title: "ะัะพัะตััั ะธ ะฟะพัะพะบะธ: ะตะดะธะฝะธัั ะฒัะฟะพะปะฝะตะฝะธั"
created: 2025-12-02
modified: 2025-12-02
type: deep-dive
status: published
area: operating-systems
confidence: high
tags:
  - topic/os
  - processes
  - threads
  - concurrency
  - type/deep-dive
  - level/intermediate
related:
  - "[[os-overview]]"
  - "[[os-scheduling]]"
  - "[[os-memory-management]]"
  - "[[os-synchronization]]"
  - "[[jvm-concurrency-overview]]"
  - "[[kotlin-coroutines]]"
prerequisites:
  - "[[data-structures-fundamentals]]"
reading_time: 45
difficulty: 6
study_status: not_started
mastery: 0
last_reviewed:
next_review:
---

# ะัะพัะตััั ะธ ะฟะพัะพะบะธ: ะตะดะธะฝะธัั ะฒัะฟะพะปะฝะตะฝะธั

ะัะพัะตัั โ ััะพ ะทะฐะฟััะตะฝะฝะฐั ะฟัะพะณัะฐะผะผะฐ ั ัะพะฑััะฒะตะฝะฝัะผ ะฐะดัะตัะฝัะผ ะฟัะพัััะฐะฝััะฒะพะผ. ะะพัะพะบ (thread) โ ััะพ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ะธะฝััััะบัะธะน ะฒะฝัััะธ ะฟัะพัะตััะฐ, ะบะพัะพัะฐั ะผะพะถะตั ะฒัะฟะพะปะฝััััั ะฝะตะทะฐะฒะธัะธะผะพ. ะะดะธะฝ ะฟัะพัะตัั ะผะพะถะตั ัะพะดะตัะถะฐัั ะผะฝะพะถะตััะฒะพ ะฟะพัะพะบะพะฒ, ะธ ะฒัะต ะพะฝะธ ัะฐะทะดะตะปััั ะฟะฐะผััั ะฟัะพัะตััะฐ. ะญัะพ ัะฐะทะดะตะปะตะฝะธะต ะฟะฐะผััะธ ะดะตะปะฐะตั ะฟะพัะพะบะธ ัััะตะบัะธะฒะฝัะผะธ ะดะปั ะฟะฐัะฐะปะปะตะปะธะทะผะฐ, ะฝะพ ัะพะทะดะฐัั ะฟัะพะฑะปะตะผั ัะธะฝััะพะฝะธะทะฐัะธะธ.

ะะฝัะตัะตัะฝัะน ัะฐะบั: ะฒ Linux ะฝะฐ ะฝะธะทะบะพะผ ััะพะฒะฝะต ะธ ะฟัะพัะตััั, ะธ ะฟะพัะพะบะธ ัะพะทะดะฐัััั ัะตัะตะท ะพะดะธะฝ ะธ ัะพั ะถะต ัะธััะตะผะฝัะน ะฒัะทะพะฒ `clone()`. ะะฐะทะปะธัะธะต ะผะตะถะดั ะฝะธะผะธ โ ััะพ ะฟัะพััะพ ะฝะฐะฑะพั ัะปะฐะณะพะฒ, ะฟะตัะตะดะฐะฒะฐะตะผัั ะฒ `clone()`. ะัะพัะตัั ัะพะทะดะฐัััั ั ัะปะฐะณะฐะผะธ, ะบะพัะพััะต ะณะพะฒะพััั "ัะบะพะฟะธัะพะฒะฐัั ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ", ะฐ ะฟะพัะพะบ โ ั ัะปะฐะณะฐะผะธ "ัะฐะทะดะตะปะธัั ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ". ะะพััะพะผั ะฒ ัะดัะต Linux ะฟะพัะพะบะธ ะธะฝะพะณะดะฐ ะฝะฐะทัะฒะฐัั "lightweight processes" (LWP).

---

## TL;DR

> **ะัะพัะตัั** โ ะทะฐะฟััะตะฝะฝะฐั ะฟัะพะณัะฐะผะผะฐ ั ะธะทะพะปะธัะพะฒะฐะฝะฝะพะน ะฟะฐะผัััั. ะะฐะบ ะพัะดะตะปัะฝะฐั ะบะฒะฐััะธัะฐ: ัะฒะพะธ ััะตะฝั, ัะฒะพั ะผะตะฑะตะปั, ัะพัะตะดะธ ะฝะต ะผะพะณัั ะทะฐะนัะธ ะฑะตะท ัะฐะทัะตัะตะฝะธั.
>
> **ะะพัะพะบ** โ ะตะดะธะฝะธัะฐ ะฒัะฟะพะปะฝะตะฝะธั ะฒะฝัััะธ ะฟัะพัะตััะฐ. ะะฐะบ ะถะธะปััั ะพะดะฝะพะน ะบะฒะฐััะธัั: ะดะตะปัั ะบััะฝั ะธ ะฒะฐะฝะฝัั, ะฝะพ ั ะบะฐะถะดะพะณะพ ัะฒะพั ะบัะพะฒะฐัั (stack).
>
> **ะะพะณะดะฐ ััะพ:** ะัะพัะตััั โ ะดะปั ะธะทะพะปััะธะธ ะธ ะฑะตะทะพะฟะฐัะฝะพััะธ (Chrome ะฒะบะปะฐะดะบะธ). ะะพัะพะบะธ โ ะดะปั ะฑััััะพะณะพ ะฟะฐัะฐะปะปะตะปะธะทะผะฐ ั ะพะฑัะธะผะธ ะดะฐะฝะฝัะผะธ (MySQL).
>
> **ะะปััะตะฒัะต ัะธัะปะฐ:** ะกะพะทะดะฐะฝะธะต ะฟัะพัะตััะฐ ~100-300ยตs, ะฟะพัะพะบะฐ ~30-50ยตs. Context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ~1.2-1.5ยตs, ะผะตะถะดั ะฟัะพัะตััะฐะผะธ ~2.2ยตs+.
>
> **ะะพะดะตะปะธ:** 1:1 (Linux โ 1 user thread = 1 kernel thread), M:N (Go goroutines โ ะผะฝะพะณะพ user threads ะฝะฐ ะฝะตัะบะพะปัะบะพ kernel threads).

---

## ะงะฐััั 1: ะะฝััะธัะธั ะฑะตะท ะบะพะดะฐ

### ๐ ะะฝะฐะปะพะณะธั 1: ะะฒะฐััะธัั ะธ ะถะธะปััั

ะัะตะดััะฐะฒั ะผะฝะพะณะพะบะฒะฐััะธัะฝัะน ะดะพะผ. **ะัะพัะตัั โ ััะพ ะพัะดะตะปัะฝะฐั ะบะฒะฐััะธัะฐ**:
- ะฃ ะบะฒะฐััะธัั ัะฒะพะธ ััะตะฝั (ะณัะฐะฝะธัั ะฟะฐะผััะธ)
- ะกะฒะพั ะผะตะฑะตะปั (ะดะฐะฝะฝัะต ะฒ heap)
- ะกะฒะพั ะฒัะพะดะฝะฐั ะดะฒะตัั ั ะทะฐะผะบะพะผ (ะธะทะพะปััะธั)
- ะกะพัะตะดะธ ะฝะต ะผะพะณัั ะทะฐะนัะธ ะฑะตะท ัะฐะทัะตัะตะฝะธั (ะผะตะถะฟัะพัะตััะฝะฐั ะธะทะพะปััะธั)

**ะะพัะพะบ โ ััะพ ะถะธะปะตั ะบะฒะฐััะธัั**:
- ะัะต ะถะธะปััั ะพะดะฝะพะน ะบะฒะฐััะธัั ะดะตะปัั ะบััะฝั ะธ ะณะพััะธะฝัั (ะพะฑัะธะน heap)
- ะะพ ั ะบะฐะถะดะพะณะพ ัะฒะพั ะบัะพะฒะฐัั ะธ ััะผะฑะพัะบะฐ (ัะฒะพะน stack)
- ะะฝะธ ะผะพะณัั ะพะฑัะฐัััั ะฝะฐะฟััะผัั, ะฑะตะท ะทะฒะพะฝะบะพะฒ (ะฑััััะฐั ะบะพะผะผัะฝะธะบะฐัะธั)
- ะัะปะธ ะพะดะธะฝ ะถะธะปะตั ััััะพะธั ะฟะพะถะฐั โ ะฟะพัััะฐะดะฐัั ะฒัะต (ะพะดะธะฝ ะฟะพัะพะบ ะผะพะถะตั ััะพะฝะธัั ะฒะตัั ะฟัะพัะตัั)

**ะะพัะตะผั Chrome ะธัะฟะพะปัะทัะตั ะฟัะพัะตััั ะดะปั ะฒะบะปะฐะดะพะบ?** ะัะปะธ ะฑั ะฒะบะปะฐะดะบะธ ะฑัะปะธ ะฟะพัะพะบะฐะผะธ, ัะฟะฐะฒัะฐั ะฒะบะปะฐะดะบะฐ (ะฟะพะถะฐั ะฒ ะบะพะผะฝะฐัะต) ัะฑะธะปะฐ ะฑั ะฒะตัั ะฑัะฐัะทะตั. ะก ะฟัะพัะตััะฐะผะธ (ะพัะดะตะปัะฝัะผะธ ะบะฒะฐััะธัะฐะผะธ) โ ัะฟะฐะปะฐ ะพะดะฝะฐ ะฒะบะปะฐะดะบะฐ, ะพััะฐะปัะฝัะต ัะฐะฑะพัะฐัั.

### ๐ด ะะฝะฐะปะพะณะธั 2: fork() ะบะฐะบ ะบะปะพะฝะธัะพะฒะฐะฝะธะต

`fork()` โ ััะพ ะบะฐะบ ะตัะปะธ ะฑั ัั ะผะพะณ ะผะณะฝะพะฒะตะฝะฝะพ ะบะปะพะฝะธัะพะฒะฐัั ัะฒะพั ะบะฒะฐััะธัั ัะพ ะฒัะตะน ะผะตะฑะตะปัั:

```
ะะพ fork():                    ะะพัะปะต fork():
โโโโโโโโโโโโโโโ               โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
โ  ะะฒะฐััะธัะฐ   โ               โ  ะะพะดะธัะตะปั   โ  โ   ะะตะฑัะฝะพะบ   โ
โ   (PID=5)   โ      โ        โ   (PID=5)   โ  โ   (PID=6)   โ
โ  x = 42     โ               โ  x = 42     โ  โ  x = 42     โ
โ  arr = [...]โ               โ  arr = [...]โ  โ  arr = [...] โ โ ะบะพะฟะธั!
โโโโโโโโโโโโโโโ               โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
```

ะะพัะปะต `fork()`:
- ะะพะดะธัะตะปั ะฟะพะปััะฐะตั PID ัะตะฑัะฝะบะฐ (return > 0)
- ะะตะฑัะฝะพะบ ะฟะพะปััะฐะตั 0 (return == 0)
- ะะทะผะตะฝะตะฝะธั ะฒ ะพะดะฝะพะน ะบะฒะฐััะธัะต ะะ ะฒะปะธััั ะฝะฐ ะดััะณัั

ะะฐะถะฝะพ: ัะพะฒัะตะผะตะฝะฝัะต ะะก ะธัะฟะพะปัะทััั **Copy-on-Write (COW)** โ ัะตะฐะปัะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต ะฟัะพะธััะพะดะธั ัะพะปัะบะพ ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ. ะญัะพ ะบะฐะบ ะตัะปะธ ะฑั ะบะปะพะฝ ะบะฒะฐััะธัั ะฑัะป ะฒะธัััะฐะปัะฝัะผ, ะธ ะผะฐัะตัะธะฐะปะธะทะพะฒะฐะปัั ัะพะปัะบะพ ะบะพะณะดะฐ ะบัะพ-ัะพ ะดะฒะธะณะฐะตั ะผะตะฑะตะปั.

### ๐ญ ะะฝะฐะปะพะณะธั 3: exec() ะบะฐะบ ััะฐะฝััะพัะผะฐัะธั

`exec()` โ ััะพ ะบะฐะบ ะตัะปะธ ะฑั ะณััะตะฝะธัะฐ ะฟัะตะฒัะฐัะธะปะฐัั ะฒ ะฑะฐะฑะพัะบั:
- ะขะตะปะพ (PID) ะพััะฐัััั ัะตะผ ะถะต
- ะะพ ะฒะฝัััะตะฝะฝะตะต ัะพะดะตัะถะธะผะพะต ะฟะพะปะฝะพัััั ะทะฐะผะตะฝัะตััั
- ะกัะฐัะฐั ะฟัะพะณัะฐะผะผะฐ ะธััะตะทะฐะตั ะฝะฐะฒัะตะณะดะฐ

ะะปะฐััะธัะตัะบะธะน ะฟะฐััะตัะฝ ะฒ Unix:
```
fork()  โ  exec()
  โ           โ
  โ           โ
ะะปะพะฝ      ะัะตะฒัะฐัะตะฝะธะต ะบะปะพะฝะฐ
ัะตะฑั      ะฒ ะดััะณัั ะฟัะพะณัะฐะผะผั
```

ะญัะพ ะบะฐะบ ัะฐะทะผะฝะพะถะตะฝะธะต: ัะพะดะธัะตะปั ัะพะทะดะฐัั ะบะปะพะฝะฐ, ะบะปะพะฝ ััะฐะฝะพะฒะธััั ะดััะณะพะน ะฟัะพะณัะฐะผะผะพะน, ัะพะดะธัะตะปั ะฟัะพะดะพะปะถะฐะตั ะถะธัั.

### ๐ ะะฝะฐะปะพะณะธั 4: Context switch ะบะฐะบ ะฟะตัะตะบะปััะตะฝะธะต ัะฐะทะณะพะฒะพัะพะฒ

ะัะตะดััะฐะฒั, ััะพ ัั ะฝะฐ ะฒะตัะตัะธะฝะบะต ะธ ะณะพะฒะพัะธัั ั 5 ะปัะดัะผะธ ะฟะพ ะพัะตัะตะดะธ:

**ะะตัะตะบะปััะตะฝะธะต ะผะตะถะดั ะปัะดัะผะธ (ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ):**
- ะขั ะฟะพะผะฝะธัั ะพะฑัะธะน ะบะพะฝัะตะบัั ะฒะตัะตัะธะฝะบะธ (ะพะฑัะฐั ะฟะฐะผััั)
- ะัะถะฝะพ ัะพะปัะบะพ ะฒัะฟะพะผะฝะธัั, ะพ ััะผ ะณะพะฒะพัะธะปะธ ั ััะธะผ ัะตะปะพะฒะตะบะพะผ (ัะพััะฐะฝะธัั/ะฒะพัััะฐะฝะพะฒะธัั ัะตะณะธัััั)
- ะััััะพ: ~1-2 ะผะธะบัะพัะตะบัะฝะดั

**ะะตัะตะบะปััะตะฝะธะต ะผะตะถะดั ะฒะตัะตัะธะฝะบะฐะผะธ (ัะฐะทะฝัะผะธ ะฟัะพัะตััะฐะผะธ):**
- ะัะถะฝะพ ะฒัะฟะพะผะฝะธัั ะะะ ัั (ัะผะตะฝะธัั ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ)
- ะะฐะฑััั ะฒัั ะพ ัะตะบััะตะน ะฒะตัะตัะธะฝะบะต (flush TLB cache)
- ะัะฟะพะผะฝะธัั ะบะพะฝัะตะบัั ะฝะพะฒะพะน ะฒะตัะตัะธะฝะบะธ
- ะะตะดะปะตะฝะฝะพ: ~2-3 ะผะธะบัะพัะตะบัะฝะดั + ะฟะพัะตัั ะบััะตะน

### ๐ฆ ะะฝะฐะปะพะณะธั 5: ะะพะดะตะปะธ ะฟะพัะพะบะพะฒ ะบะฐะบ ะผะพะดะตะปะธ ัะฐะบัะธ

**1:1 (ะพะดะธะฝ user thread = ะพะดะธะฝ kernel thread)** โ ะบะฐะบ ะพะฑััะฝะพะต ัะฐะบัะธ:
- ะะดะธะฝ ะฟะฐััะฐะถะธั (ะฟะพัะพะบ) = ะพะดะฝะฐ ะผะฐัะธะฝะฐ (kernel thread)
- ะะพัะพะณะพ, ะฝะพ ะฝะฐะดัะถะฝะพ
- ะขะฐะบ ัะฐะฑะพัะฐะตั Linux pthreads

**M:1 (ะผะฝะพะณะพ user threads ะฝะฐ ะพะดะธะฝ kernel thread)** โ ะบะฐะบ ะฐะฒัะพะฑัั:
- ะะฝะพะณะพ ะฟะฐััะฐะถะธัะพะฒ, ะพะดะฝะฐ ะผะฐัะธะฝะฐ
- ะัะปะธ ะฐะฒัะพะฑัั ะทะฐััััะป (ะฑะปะพะบะธััััะธะน syscall) โ ะฒัะต ะถะดัั
- ะขะฐะบ ัะฐะฑะพัะฐะปะธ ััะฐััะต green threads

**M:N (ะผะฝะพะณะพ user threads ะฝะฐ ะฝะตัะบะพะปัะบะพ kernel threads)** โ ะบะฐะบ Uber Pool:
- ะะฝะพะณะพ ะฟะฐััะฐะถะธัะพะฒ ัะฐัะฟัะตะดะตะปััััั ะฟะพ ะฝะตัะบะพะปัะบะธะผ ะผะฐัะธะฝะฐะผ
- ะะธัะฟะตััะตั (runtime scheduler) ัะตัะฐะตั ะบัะพ ะฒ ะบะฐะบะพะน ะผะฐัะธะฝะต
- ะขะฐะบ ัะฐะฑะพัะฐัั Go goroutines (~2KB) ะธ Kotlin coroutines

```
1:1 ะผะพะดะตะปั:          M:N ะผะพะดะตะปั:
U U U U U            U U U U U U U U
โ โ โ โ โ               \ | | | /
K K K K K                 K K K
                      (scheduler)
```

### ๐ข ะงะธัะปะตะฝะฝะฐั ะธะฝััะธัะธั

| ะะฟะตัะฐัะธั | ะัะตะผั | ะกัะฐะฒะฝะตะฝะธะต |
|----------|-------|-----------|
| ะกะพะทะดะฐัั ะฟัะพัะตัั | ~100-300 ยตs | ะะพัััะพะธัั ะบะฒะฐััะธัั |
| ะกะพะทะดะฐัั ะฟะพัะพะบ | ~30-50 ยตs | ะะพััะฐะฒะธัั ะบัะพะฒะฐัั |
| ะกะพะทะดะฐัั goroutine | ~0.3 ยตs | ะะพะปะพะถะธัั ะฟะพะดััะบั |
| Context switch (ะฟะพัะพะบะธ) | ~1.2-1.5 ยตs | ะะตัะตะบะปััะธัั ะฒะทะณะปัะด |
| Context switch (ะฟัะพัะตััั) | ~2.2+ ยตs | ะัะนัะธ ะธะท ะบะพะผะฝะฐัั |
| ะะฐะผััั ะฝะฐ ะฟัะพัะตัั | ~4-10 MB min | ะฆะตะปะฐั ะบะฒะฐััะธัะฐ |
| ะะฐะผััั ะฝะฐ ะฟะพัะพะบ | ~1-8 MB (stack) | ะะดะฝะฐ ะบะพะผะฝะฐัะฐ |
| ะะฐะผััั ะฝะฐ goroutine | ~2-8 KB | ะะดะธะฝ ัััะป |

**ะัะธะผะตั:** ะะตะฑ-ัะตัะฒะตั ั 10,000 ัะพะตะดะธะฝะตะฝะธะน
- ะะพัะพะบะธ: 10,000 ร 2MB = 20GB ะฟะฐะผััะธ ๐ฑ
- Goroutines: 10,000 ร 8KB = 80MB ะฟะฐะผััะธ โ

---

## ะงะฐััั 2: ะะพัะตะผั ััะพ ัะปะพะถะฝะพ

### โ ะัะธะฑะบะฐ 1: ะััะฐะฝะธัะฐ process vs thread

**ะกะะะะขะะ:** ะกััะดะตะฝั ะฟะธัะตั "ัะพะทะดะฐะผ ะฝะพะฒัะน ะฟัะพัะตัั ะดะปั ะฟะฐัะฐะปะปะตะปัะฝะพะน ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั" ะบะพะณะดะฐ ะฝัะถะตะฝ ะฟะพัะพะบ.

**ะะะงะะะฃ ะะะะะะะะะข:** ะ ะฑััั ัะปะพะฒะฐ "ะฟัะพัะตัั" ะธ "ะฟะพัะพะบ" ัะผะตัะธะฒะฐัััั. "Process" ะฒ ะฐะฝะณะปะธะนัะบะพะผ = ะปัะฑะพะน ะฟัะพัะตัั ะฒัะฟะพะปะฝะตะฝะธั.

**ะะะ ะะะะฏะะะฏะะขะกะฏ:**
```c
// ะกััะดะตะฝั ัะพัะตั ะฟะฐัะฐะปะปะตะปัะฝะพ ะพะฑัะฐะฑะพัะฐัั ะผะฐััะธะฒ
for (int i = 0; i < 4; i++) {
    pid_t pid = fork();  // โ ะกะพะทะดะฐัั 4 ะะะะฆะะกะกะ
    if (pid == 0) {
        process_chunk(data, i);  // ะะฐะถะดัะน ัะฐะฑะพัะฐะตั ั ะะะะะะ ะดะฐะฝะฝัั!
        exit(0);
    }
}
// ะะตะทัะปััะฐัั ะฟะพัะตััะฝั โ ะบะฐะถะดัะน ะฟัะพัะตัั ะธะทะผะตะฝะธะป ัะฒะพั ะบะพะฟะธั
```

**ะะะจะะะะ:**
```c
// ะะปั ะพะฑัะธั ะดะฐะฝะฝัั โ ะฟะพัะพะบะธ
pthread_t threads[4];
for (int i = 0; i < 4; i++) {
    pthread_create(&threads[i], NULL, process_chunk, &args[i]);
}
// ะัะต ะฟะพัะพะบะธ ะฒะธะดัั ะธ ะธะทะผะตะฝััั ะะะะ ะดะฐะฝะฝัะต
```

**ะะะะะะะ:**
- ะัะถะฝะฐ ะธะทะพะปััะธั ะธ ะฑะตะทะพะฟะฐัะฝะพััั โ ะฟัะพัะตัั
- ะัะถะฝั ะพะฑัะธะต ะดะฐะฝะฝัะต ะธ ัะบะพัะพััั โ ะฟะพัะพะบ

---

### โ ะัะธะฑะบะฐ 2: ะะต ะถะดะฐัั ะทะฐะฒะตััะตะฝะธั ะฟะพัะพะผะบะพะฒ (zombie ะฟัะพัะตััั)

**ะกะะะะขะะ:** `ps aux | grep Z` ะฟะพะบะฐะทัะฒะฐะตั ะฟัะพัะตััั ะฒ ัะพััะพัะฝะธะธ "Z" (zombie).

**ะะะงะะะฃ ะะะะะะะะะข:** ะะพะณะดะฐ ะฟัะพัะตัั ะทะฐะฒะตััะฐะตััั, ัะดัะพ ัะพััะฐะฝัะตั ะตะณะพ exit status ะฟะพะบะฐ ัะพะดะธัะตะปั ะฝะต ะฒัะทะพะฒะตั `wait()`. ะัะปะธ ัะพะดะธัะตะปั ะฝะต ะฒัะทัะฒะฐะตั โ zombie ะฝะฐะบะฐะฟะปะธะฒะฐัััั.

**ะะะ ะะะะฏะะะฏะะขะกะฏ:**
```c
for (int i = 0; i < 100; i++) {
    if (fork() == 0) {
        do_work();
        exit(0);  // ะะตะฑัะฝะพะบ ะทะฐะฒะตััะธะปัั
    }
    // โ ะะพะดะธัะตะปั ะะ ะฒัะทัะฒะฐะตั wait()
}
// ะขะตะฟะตัั ั ะฝะฐั 100 zombie ะฟัะพัะตััะพะฒ!
```

**ะะะจะะะะ:**
```c
// ะะฐัะธะฐะฝั 1: ะฏะฒะฝะพ ะถะดะฐัั
for (int i = 0; i < 100; i++) {
    pid_t pid = fork();
    if (pid == 0) {
        do_work();
        exit(0);
    }
}
while (wait(NULL) > 0);  // โ ะะพะถะดะฐัััั ะฒัะตั

// ะะฐัะธะฐะฝั 2: ะะณะฝะพัะธัะพะฒะฐัั SIGCHLD (zombie auto-reap)
signal(SIGCHLD, SIG_IGN);  // โ ะฏะดัะพ ัะฐะผะพ ัะฑะตััั zombies
```

---

### โ ะัะธะฑะบะฐ 3: ะะตะฟัะฐะฒะธะปัะฝะพะต ัะฐะทะดะตะปะตะฝะธะต ะดะฐะฝะฝัั ะผะตะถะดั ะฟะพัะพะบะฐะผะธ

**ะกะะะะขะะ:** Race condition, ัะปััะฐะนะฝัะต ะทะฝะฐัะตะฝะธั, ะฟัะพะณัะฐะผะผะฐ ัะฐะฑะพัะฐะตั ะฟะพ-ัะฐะทะฝะพะผั ะฟัะธ ะบะฐะถะดะพะผ ะทะฐะฟััะบะต.

**ะะะงะะะฃ ะะะะะะะะะข:** ะะพัะพะบะธ ะดะตะปัั heap, ะฝะพ ะบะฐะถะดัะน ะธะผะตะตั ัะฒะพะน stack. ะะตัะตะดะฐัะฐ ัะบะฐะทะฐัะตะปั ะฝะฐ ะปะพะบะฐะปัะฝัั ะฟะตัะตะผะตะฝะฝัั โ ะพัะธะฑะบะฐ.

**ะะะ ะะะะฏะะะฏะะขะกะฏ:**
```c
void* thread_func(void* arg) {
    int id = *(int*)arg;
    printf("Thread %d\n", id);  // ะะตัะฐัะฐะตั ัะปััะฐะนะฝัะต ัะธัะปะฐ!
    return NULL;
}

int main() {
    pthread_t threads[4];
    for (int i = 0; i < 4; i++) {
        pthread_create(&threads[i], NULL, thread_func, &i);  // โ &i!
        // i ะผะตะฝัะตััั ะฒ ัะธะบะปะต, ะฐ ะฒัะต ะฟะพัะพะบะธ ัะธัะฐัั ะพะดะธะฝ ะธ ัะพั ะถะต ะฐะดัะตั
    }
}
// ะัะฒะพะด: "Thread 4 Thread 4 Thread 4 Thread 4" ะธะปะธ ััะถะต
```

**ะะะจะะะะ:**
```c
int ids[4];  // ะะฐััะธะฒ ะฒ heap/static
for (int i = 0; i < 4; i++) {
    ids[i] = i;
    pthread_create(&threads[i], NULL, thread_func, &ids[i]);  // โ
}
// ะะปะธ ะฟะตัะตะดะฐัั ะทะฝะฐัะตะฝะธะต ะฝะฐะฟััะผัั (cast to void*)
pthread_create(&t, NULL, func, (void*)(intptr_t)i);  // โ
```

---

### โ ะัะธะฑะบะฐ 4: ะะปะพะบะธััััะธะต ะฒัะทะพะฒั ะฒ green threads/goroutines

**ะกะะะะขะะ:** ะัะพะณัะฐะผะผะฐ ะฝะฐ Go "ะทะฐะฒะธัะฐะตั", ะฝะตัะผะพััั ะฝะฐ ัััััะธ goroutines.

**ะะะงะะะฃ ะะะะะะะะะข:** Green threads/goroutines ัะฐะฑะพัะฐัั ะฟะพะฒะตัั ะพะณัะฐะฝะธัะตะฝะฝะพะณะพ ัะธัะปะฐ OS threads. ะะปะพะบะธััััะธะน syscall ะฑะปะพะบะธััะตั ะฒะตัั OS thread.

**ะะะ ะะะะฏะะะฏะะขะกะฏ:**
```go
for i := 0; i < 10000; i++ {
    go func() {
        // โ CGO ะฒัะทะพะฒ ะธะปะธ ะฑะปะพะบะธััััะธะน syscall
        result := C.blocking_c_function()  // ะะปะพะบะธััะตั OS thread!
    }()
}
// ะัะต GOMAXPROCS OS threads ะทะฐะฑะปะพะบะธัะพะฒะฐะฝั โ ะฒัั ะฒะธัะธั
```

**ะะะจะะะะ:**
- ะัะฟะพะปัะทะพะฒะฐัั ะฝะตะฑะปะพะบะธััััะธะต API (net/http ะฒะผะตััะพ CGO)
- ะฃะฒะตะปะธัะธัั GOMAXPROCS ะดะปั CGO-heavy ะบะพะดะฐ
- ะัะฟะพะปัะทะพะฒะฐัั worker pool ะดะปั ะฑะปะพะบะธััััะธั ะพะฟะตัะฐัะธะน:

```go
// โ Worker pool ะดะปั ะฑะปะพะบะธััััะธั ะพะฟะตัะฐัะธะน
workerPool := make(chan struct{}, 100)  // ะะธะผะธั ะฑะปะพะบะธััััะธั ะฒัะทะพะฒะพะฒ
for i := 0; i < 10000; i++ {
    go func() {
        workerPool <- struct{}{}  // Acquire
        result := C.blocking_c_function()
        <-workerPool  // Release
    }()
}
```

---

### โ ะัะธะฑะบะฐ 5: ะะตะฟัะฐะฒะธะปัะฝัะน ะฒัะฑะพั ะผะตะถะดั fork() ะธ pthread_create()

**ะกะะะะขะะ:** ะัะพะณัะฐะผะผะฐ ะผะตะดะปะตะฝะฝะฐั ะธะปะธ ะธัะฟะพะปัะทัะตั ัะปะธัะบะพะผ ะผะฝะพะณะพ ะฟะฐะผััะธ.

**ะะะงะะะฃ ะะะะะะะะะข:** ะะตะฟะพะฝะธะผะฐะฝะธะต ะบะพะณะดะฐ ะฝัะถะฝะฐ ะธะทะพะปััะธั (ะฟัะพัะตัั) vs ะพะฑัะธะต ะดะฐะฝะฝัะต (ะฟะพัะพะบ).

**ะขะะะะะฆะ ะะะจะะะะ:**

| ะกัะตะฝะฐัะธะน | ะัะฑะพั | ะะพัะตะผั |
|----------|-------|--------|
| ะะฐัะฐะปะปะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะผะฐััะธะฒะฐ | pthread | ะะฑัะธะต ะดะฐะฝะฝัะต, ะผะธะฝะธะผัะผ overhead |
| ะะทะพะปะธัะพะฒะฐะฝะฝัะต sandbox'ั | fork() | ะะฐะดะตะฝะธะต ะพะดะฝะพะณะพ ะฝะต ะทะฐััะพะฝะตั ะดััะณะธั |
| Web worker (ะฑัะฐัะทะตั) | ะัะพัะตัั | ะะตะทะพะฟะฐัะฝะพััั, ะธะทะพะปััะธั |
| HTTP handlers ะฒ ัะตัะฒะตัะต | ะะพัะพะบะธ | ะะฑัะธะน ะบัั, ะฑััััะพะต ัะพะทะดะฐะฝะธะต |
| ะะฐะณััะทะบะฐ ะฟะปะฐะณะธะฝะพะฒ | ะัะพัะตัั | ะะฐัะธัะฐ ะพั ะฟะฐะดะตะฝะธั/exploit ะฟะปะฐะณะธะฝะฐ |
| ะะฐัะฐะปะปะตะปัะฝัะต ะฒััะธัะปะตะฝะธั | ะะพัะพะบะธ | ะัะถะตะฝ ะดะพัััะฟ ะบ ะพะฑัะธะผ ะดะฐะฝะฝัะผ |

---

### โ ะัะธะฑะบะฐ 6: ะัะผะฐัั, ััะพ fork() ะผะณะฝะพะฒะตะฝะตะฝ ั COW

**ะกะะะะขะะ:** "fork() ะถะต ะบะพะฟะธััะตั ะปะตะฝะธะฒะพ, ะทะฝะฐัะธั ััะพ ะฑะตัะฟะปะฐัะฝะพ!"

**ะะะงะะะฃ ะะะะะะะะะข:** Copy-on-Write ัะพะทะดะฐัั ะธะปะปัะทะธั ะฑะตัะฟะปะฐัะฝะพะณะพ ะบะพะฟะธัะพะฒะฐะฝะธั.

**ะะะะะฌะะะกะขะฌ:**
```
fork() ะฒัั ัะฐะฒะฝะพ ะดะพะปะถะตะฝ:
1. ะกะพะทะดะฐัั ะฝะพะฒัะน PCB ะฒ ัะดัะต
2. ะกะบะพะฟะธัะพะฒะฐัั ัะฐะฑะปะธัั ัััะฐะฝะธั (ะฝะต ะดะฐะฝะฝัะต, ะฝะพ ะฒัั ัะฐะฒะฝะพ ัะฐะฑะพัะฐ)
3. ะกะบะพะฟะธัะพะฒะฐัั file descriptors
4. ะะฑะฝะพะฒะธัั ะผะตัะฐะดะฐะฝะฝัะต

ะัะธ N MB ะฟะฐะผััะธ ั M ัััะฐะฝะธัะฐะผะธ:
- ะขะฐะฑะปะธัะฐ ัััะฐะฝะธั: M ร 8 bytes = ะทะฝะฐัะธัะตะปัะฝัะน ัะฐะทะผะตั
- 10GB ะฟัะพัะตัั โ ~2.5M ัััะฐะฝะธั โ ~20MB ะฝะฐ ัะฐะฑะปะธัั
```

**ะะะ ะะะะะะกะขะะะฆะะ:**
```c
// ะัะพัะตัั ั 10GB ะดะฐะฝะฝัั
char* huge = malloc(10ULL * 1024 * 1024 * 1024);
memset(huge, 'x', 10ULL * 1024 * 1024 * 1024);

// fork() ะฑัะดะตั ะะ ะผะณะฝะพะฒะตะฝะฝัะผ โ ะบะพะฟะธัะพะฒะฐะฝะธะต page tables
time_t start = clock();
if (fork() == 0) exit(0);
wait(NULL);
printf("fork took: %f ms\n", (clock()-start)*1000.0/CLOCKS_PER_SEC);
// ะะตะทัะปััะฐั: ัะพัะฝะธ ะผะธะปะปะธัะตะบัะฝะด!
```

---

## ะงะฐััั 3: ะะตะฝัะฐะปัะฝัะต ะผะพะดะตะปะธ

### ๐ง ะะพะดะตะปั 1: "ะัะพัะตัั = ะบะพะฝัะตะนะฝะตั, ะฟะพัะพะบ = ะธัะฟะพะปะฝะธัะตะปั"

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะะะะฆะะกะก (ะบะพะฝัะตะนะฝะตั)                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ                     ะะะกะฃะะกะซ                          โโ
โ  โ  โข ะะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ (heap, data, code)         โโ
โ  โ  โข ะัะบััััะต ัะฐะนะปั (file descriptors)                โโ
โ  โ  โข ะกะพะบะตัั, ะฟะฐะนะฟั, ัะธะณะฝะฐะปั                           โโ
โ  โ  โข PID, permissions, working dir                    โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                         โ
โ    Thread 1        Thread 2        Thread 3             โ
โ    โโโโโโโโ        โโโโโโโโ        โโโโโโโโ            โ
โ    โStack โ        โStack โ        โStack โ            โ
โ    โ  โ   โ        โ  โ   โ        โ  โ   โ            โ
โ    โRegs  โ        โRegs  โ        โRegs  โ            โ
โ    โTLS   โ        โTLS   โ        โTLS   โ            โ
โ    โโโโโโโโ        โโโโโโโโ        โโโโโโโโ            โ
โ       โ               โ               โ                 โ
โ       โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโ                 โ
โ                       โ                                 โ
โ              ะะฑัะธะน ะดะพัััะฟ ะบ ัะตััััะฐะผ                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะะพะณะดะฐ ะดัะผะฐะตัะต ะพ ัะพะผ, ััะพ ัะฐะทะดะตะปัะตััั, ะฐ ััะพ ะฝะตั.

---

### ๐ง ะะพะดะตะปั 2: "ะะธะทะฝะตะฝะฝัะน ัะธะบะป ะบะฐะบ ะบะพะฝะตัะฝัะน ะฐะฒัะพะผะฐั"

```
                    โโโโโโโโโโโโโโโ
                    โ   Created   โ
                    โโโโโโโโฌโโโโโโโ
                           โ start()
                           โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                    READY                      โ
    โ  (ะฒ ะพัะตัะตะดะธ ะฟะปะฐะฝะธัะพะฒัะธะบะฐ, ะถะดัั CPU)          โ
    โโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ scheduler ะฒัะฑัะฐะป
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ            RUNNING             โ
        โ   (ะฒัะฟะพะปะฝัะตััั ะฝะฐ CPU)         โ
        โโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโฌโ
          โ            โ                โ
    yield/โ      I/O   โ           exit โ
  preempt โ    request โ                โ
          โ            โ                โ
       READY        WAITING         TERMINATED
                       โ                  โ
                 I/O done              zombie ะดะพ
                       โ               wait()
                       โ                  โ
                    READY              CLEANUP
```

**ะะปััะตะฒัะต ะฟะตัะตัะพะดั:**
- READY โ RUNNING: ัะพะปัะบะพ ะฟะปะฐะฝะธัะพะฒัะธะบ ัะตัะฐะตั
- RUNNING โ WAITING: ะฟะพัะพะบ ัะฐะผ ะทะฐะฟัะพัะธะป I/O
- RUNNING โ READY: preemption (ะบะฒะฐะฝั ะฒัะตะผะตะฝะธ ะธัััะบ)

---

### ๐ง ะะพะดะตะปั 3: "fork() + exec() = spawn() ะฒ ะดะฒะฐ ัะฐะณะฐ"

```
Windows CreateProcess():     Unix fork() + exec():
โโโโโโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ CreateProcess(       โ     โ if (fork() == 0) {               โ
โ   "program.exe",     โ     โ     // ะะตะฑัะฝะพะบ                   โ
โ   args,              โ     โ     setup_environment();         โ
โ   env,               โ     โ     redirect_io();               โ
โ   ...                โ     โ     exec("program", args);       โ
โ )                    โ     โ }                                โ
โ // ะะดะธะฝ ะฒัะทะพะฒ        โ     โ // ะะฒะฐ ะฒัะทะพะฒะฐ = ะณะธะฑะบะพััั!        โ
โโโโโโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะตะธะผััะตััะฒะฐ Unix-ะฟะพะดัะพะดะฐ:**
1. ะะตะถะดั fork() ะธ exec() ะผะพะถะฝะพ ะฝะฐัััะพะธัั ะพะบััะถะตะฝะธะต ัะตะฑัะฝะบะฐ
2. ะะพะถะฝะพ ะฟะตัะตะฝะฐะฟัะฐะฒะธัั stdin/stdout (`dup2()`)
3. ะะพะถะฝะพ ัััะฐะฝะพะฒะธัั ะพะณัะฐะฝะธัะตะฝะธั (`setrlimit()`)
4. ะะพะถะฝะพ ัะผะตะฝะธัั ะฟะพะปัะทะพะฒะฐัะตะปั (`setuid()`)

**ะญัะพ ัะพ, ะบะฐะบ ัะฐะฑะพัะฐะตั shell:**
```bash
$ ls -la | grep foo > output.txt

Shell ะดะตะปะฐะตั:
1. fork()  โ  fork()          # ะกะพะทะดะฐัั ะดะฒัั ะดะตัะตะน
2. dup2() ะดะปั pipe            # ะะฐัััะพะธัั ะฟะฐะนะฟ ะผะตะถะดั ะฝะธะผะธ
3. dup2() ะดะปั output.txt      # ะะตัะตะฝะฐะฟัะฐะฒะธัั ะฒัะฒะพะด
4. exec("ls") / exec("grep")  # ะะฐะผะตะฝะธัั ะฟัะพะณัะฐะผะผั
```

---

### ๐ง ะะพะดะตะปั 4: "ะขะฐะฑะปะธัะฐ ะฒัะฑะพัะฐ ะผะพะดะตะปะธ concurrency"

| ะฅะฐัะฐะบัะตัะธััะธะบะฐ | ะัะพัะตััั | ะะพัะพะบะธ (1:1) | Green Threads (M:N) |
|----------------|----------|--------------|---------------------|
| **ะะทะพะปััะธั** | โ ะะพะปะฝะฐั | โ ะะตั | โ ะะตั |
| **ะะฑัะธะต ะดะฐะฝะฝัะต** | โ ะงะตัะตะท IPC | โ ะะฐ | โ ะะฐ |
| **ะกะพะทะดะฐะฝะธะต** | ~200ยตs | ~50ยตs | ~0.5ยตs |
| **ะะฐะผััั** | ~10MB | ~2MB | ~2KB |
| **ะะฐัััะฐะฑ** | ~1000 | ~10,000 | ~1,000,000 |
| **ะะปะพะบ. I/O** | โ OK | โ OK | โ๏ธ ะัะพะฑะปะตะผะฐ |
| **CPU-bound** | โ ะัะต ัะดัะฐ | โ ะัะต ัะดัะฐ | โ๏ธ ะะฐะฒะธัะธั ะพั M |
| **ะะฐะดะตะฝะธะต** | ะะทะพะปะธัะพะฒะฐะฝะพ | ะะตัั ะฟัะพัะตัั | ะะตัั ะฟัะพัะตัั |

**ะะปะณะพัะธัะผ ะฒัะฑะพัะฐ:**
```
ะัะถะฝะฐ ะธะทะพะปััะธั/ะฑะตะทะพะฟะฐัะฝะพััั?
โโโ ะะ โ ะัะพัะตััั (Chrome tabs, sandboxes)
โโโ ะะะข โ ะัะถะตะฝ ะผะฐัััะฐะฑ >10K?
          โโโ ะะ โ Green threads (Go, Kotlin)
          โโโ ะะะข โ ะะฑััะฝัะต ะฟะพัะพะบะธ (Java, C++)
```

---

### ๐ง ะะพะดะตะปั 5: "ะกัะพะธะผะพััั ะบะฐะบ ะฟะธัะฐะผะธะดะฐ"

```
                    โฑโฒ
                   โฑ  โฒ
                  โฑ G  โฒ  Goroutine: ~2KB, ~0.3ยตs
                 โฑโโโโโโโฒ
                โฑ        โฒ
               โฑ  Thread  โฒ  Thread: ~2MB, ~50ยตs
              โฑโโโโโโโโโโโโโฒ
             โฑ              โฒ
            โฑ    Process     โฒ  Process: ~10MB, ~200ยตs
           โฑโโโโโโโโโโโโโโโโโโโฒ

ะัะฐะฒะธะปะพ: ะัะฟะพะปัะทัะน ัะฐะผัะน ะปัะณะบะธะน ะฟัะธะผะธัะธะฒ,
         ะบะพัะพััะน ัะตัะฐะตั ัะฒะพั ะทะฐะดะฐัั
```

**ะัะธะผะตัั ะฟัะธะผะตะฝะตะฝะธั:**
- 100 ัะพะตะดะธะฝะตะฝะธะน ะบ ะะ โ Thread pool (ัะธะบัะธัะพะฒะฐะฝะฝัะน ัะฐะทะผะตั)
- 10,000 websocket ะบะปะธะตะฝัะพะฒ โ Goroutines
- ะะปะฐะณะธะฝั ั ะฝะตะดะพะฒะตัะตะฝะฝัะผ ะบะพะดะพะผ โ ะัะพัะตััั (ะธะทะพะปััะธั)
- ะะฐัะฐะปะปะตะปัะฝัะน ะฟะฐััะธะฝะณ JSON โ Goroutines ะธะปะธ ะฟะพัะพะบะธ
- CI/CD runner โ ะัะพัะตััั (ะธะทะพะปััะธั ะผะตะถะดั jobs)

---

## Prerequisites

| ะขะตะผะฐ | ะะฐัะตะผ ะฝัะถะฝะพ | ะะดะต ะธะทััะธัั |
|------|-------------|-------------|
| [[os-overview]] | ะะฐะทะพะฒัะต ะบะพะฝัะตะฟัะธะธ ะะก (syscalls, kernel/user mode), ะฟะพะฝะธะผะฐะฝะธะต ััะพ ัะฐะบะพะต context switch | ะัะตะดัะดััะธะน ะผะฐัะตัะธะฐะป ัะฐะทะดะตะปะฐ |
| ะฃะบะฐะทะฐัะตะปะธ ะธ ะฟะฐะผััั (stack vs heap) | ะะพะฝะธะผะฐะฝะธะต ััััะบัััั ะฟะฐะผััะธ ะฟัะพัะตััะฐ, ะฟะพัะตะผั ะฟะพัะพะบะธ ะดะตะปัั heap ะฝะพ ะฝะต stack | [Learn C - Pointers](https://www.learn-c.org/en/Pointers) |
| ะะฐะทะพะฒัะน C | ะัะธะผะตัั ะบะพะดะฐ ะฝะฐ C ะดะปั fork(), pthread | [Learn C](https://www.learn-c.org/) โ ะพะฝะปะฐะนะฝ ะฟัะฐะบัะธะบะฐ |
| ะะพะผะฐะฝะดะฝะฐั ัััะพะบะฐ Linux | ะัะฐะบัะธัะตัะบะฐั ัะฐะฑะพัะฐ ั ะฟัะพัะตััะฐะผะธ (ps, top, kill) | [Linux Journey](https://linuxjourney.com/) |

**ะัะตะผั ะฝะฐ ะฟะพะดะณะพัะพะฒะบั:** ~1 ะฝะตะดะตะปั ะตัะปะธ ัะถะต ะทะฝะฐะตัะต C, ~2-3 ะฝะตะดะตะปะธ ั ะฝัะปั

---

## ะขะตัะผะธะฝะพะปะพะณะธั ะดะปั ะฝะพะฒะธัะบะพะฒ

| ะขะตัะผะธะฝ | ะงัะพ ััะพ | ะะฝะฐะปะพะณะธั ะธะท ะถะธะทะฝะธ |
|--------|---------|-------------------|
| **ะัะพัะตัั** | ะะฐะฟััะตะฝะฝะฐั ะฟัะพะณัะฐะผะผะฐ ั ะธะทะพะปะธัะพะฒะฐะฝะฝัะผ ะฐะดัะตัะฝัะผ ะฟัะพัััะฐะฝััะฒะพะผ | ะัะดะตะปัะฝะฐั ะบะฒะฐััะธัะฐ: ัะฒะพะธ ััะตะฝั, ะผะตะฑะตะปั, ัะพัะตะดะธ ะฝะต ะผะพะณัั ะฒะพะนัะธ |
| **ะะพัะพะบ (Thread)** | ะะดะธะฝะธัะฐ ะฒัะฟะพะปะฝะตะฝะธั ะฒะฝัััะธ ะฟัะพัะตััะฐ, ะดะตะปะธั ะฟะฐะผััั ั ะดััะณะธะผะธ ะฟะพัะพะบะฐะผะธ | ะะธะปะตั ะบะฒะฐััะธัั: ั ะบะฐะถะดะพะณะพ ัะฒะพั ะบัะพะฒะฐัั (stack), ะฝะพ ะพะฑัะฐั ะบััะฝั (heap) |
| **PCB** | Process Control Block โ "ะฟะฐัะฟะพัั" ะฟัะพัะตััะฐ ะฒ ัะดัะต (PID, ัะพััะพัะฝะธะต, ัะตััััั) | ะะฐััะพัะบะฐ ะฟะฐัะธะตะฝัะฐ ะฒ ะฑะพะปัะฝะธัะต: ะฒัั ะธะฝัะพัะผะฐัะธั ะพ ะฝัะผ |
| **PID** | Process ID โ ัะฝะธะบะฐะปัะฝัะน ะฝะพะผะตั ะฟัะพัะตััะฐ | ะะพะผะตั ะฟะฐัะฟะพััะฐ โ ะพะดะฝะพะทะฝะฐัะฝะพ ะธะดะตะฝัะธัะธัะธััะตั |
| **TID** | Thread ID โ ะฝะพะผะตั ะฟะพัะพะบะฐ ะฒะฝัััะธ ะฟัะพัะตััะฐ | ะะพะผะตั ะบัะพะฒะฐัะธ ะฒ ะพะฑัะตะถะธัะธะธ โ ัะฝะธะบะฐะปะตะฝ ะฒ ะบะพะผะฝะฐัะต |
| **fork()** | Syscall ะดะปั ัะพะทะดะฐะฝะธั ะบะพะฟะธะธ ะฟัะพัะตััะฐ (ะบะปะพะฝะธัะพะฒะฐะฝะธะต) | ะะปะพะฝะธัะพะฒะฐะฝะธะต ะพะฒะตัะบะธ ะะพะปะปะธ โ ัะพัะฝะฐั ะบะพะฟะธั ัะพะดะธัะตะปั |
| **exec()** | ะะฐะผะตะฝะฐ ะพะฑัะฐะทะฐ ะฟัะพัะตััะฐ ะฝะพะฒะพะน ะฟัะพะณัะฐะผะผะพะน | ะขัะฐะฝััะพัะผะฐัะธั: ะณััะตะฝะธัะฐ โ ะฑะฐะฑะพัะบะฐ (ัะตะปะพ ัะพ ะถะต, ัะพะดะตัะถะธะผะพะต ะฝะพะฒะพะต) |
| **Stack** | ะะฐะผััั ะดะปั ะปะพะบะฐะปัะฝัั ะฟะตัะตะผะตะฝะฝัั ะธ ะฒัะทะพะฒะพะฒ ััะฝะบัะธะน (ั ะบะฐะถะดะพะณะพ ะฟะพัะพะบะฐ ัะฒะพะน) | ะกัะพะฟะบะฐ ัะฐัะตะปะพะบ: ะดะพะฑะฐะฒะปัะตัั ัะฒะตััั, ะฑะตัััั ัะฒะตััั (LIFO) |
| **Heap** | ะะธะฝะฐะผะธัะตัะบะธ ะฒัะดะตะปัะตะผะฐั ะฟะฐะผััั (ะพะฑัะฐั ะดะปั ะฒัะตั ะฟะพัะพะบะพะฒ) | ะะฑัะธะน ัะบะปะฐะด: ะปัะฑะพะน ะผะพะถะตั ะฒะทััั ะธ ะฟะพะปะพะถะธัั |
| **Zombie** | ะะฐะฒะตัััะฝะฝัะน ะฟัะพัะตัั, ะถะดััะธะน ะฟะพะบะฐ ัะพะดะธัะตะปั ะทะฐะฑะตััั ะตะณะพ ััะฐััั | ะขะตะปะพ ะฒ ะผะพัะณะต: ัะผะตั, ะฝะพ ะดะพะบัะผะตะฝัั ะตัั ะฝะต ะพัะพัะผะปะตะฝั |
| **Orphan** | ะัะพัะตัั, ัะตะน ัะพะดะธัะตะปั ัะผะตั ัะฐะฝััะต ะฝะตะณะพ | ะกะธัะพัะฐ: ัััะฝะพะฒะปัะตััั ะฟัะพัะตััะพะผ init (PID 1) |
| **clone()** | ะะฐะทะพะฒัะน syscall Linux ะดะปั ัะพะทะดะฐะฝะธั ะฟัะพัะตััะพะฒ ะธ ะฟะพัะพะบะพะฒ (ัะตัะตะท ัะปะฐะณะธ) | ะฃะฝะธะฒะตััะฐะปัะฝัะน 3D-ะฟัะธะฝัะตั: ะฟะพ ัะปะฐะณะฐะผ ะฟะตัะฐัะฐะตั ะบะฒะฐััะธัั ะธะปะธ ะบัะพะฒะฐัั |
| **TLS** | Thread-Local Storage โ ะฟะฐะผััั, ัะฝะธะบะฐะปัะฝะฐั ะดะปั ะบะฐะถะดะพะณะพ ะฟะพัะพะบะฐ | ะะธัะฝัะน ััะธะบ ะฒ ะพะฑัะตะผ ะพัะธัะต: ัะพะปัะบะพ ัะฒะพะน |
| **Green Threads** | ะะพัะพะบะธ ะฒ user space, ะะก ะฝะต ะทะฝะฐะตั ะพ ะฝะธั | ะะบัััั ะฒ ะพะดะฝะพะผ ัะฟะตะบัะฐะบะปะต: ัะตะถะธัััั (runtime) ัะตัะฐะตั ะบัะพ ะณะพะฒะพัะธั, ัะตะฐัั (ะะก) ะฒะธะดะธั ะพะดะธะฝ ัะฟะตะบัะฐะบะปั |
| **Goroutine** | ะะตะณะบะพะฒะตัะฝัะน "ะฟะพัะพะบ" ะฒ Go (~2KB ะฒะผะตััะพ ~8MB ั OS thread) | ะะฐะฟะธัะบะฐ vs ะฟะธััะผะพ: ะณะพัััะธะฝะฐ ะปะตะณัะต ะธ ะดะตัะตะฒะปะต |

---

## ะงัะพ ัะฐะบะพะต ะฟัะพัะตัั

ะัะพัะตัั โ ััะพ ะฝะต ะฟัะพััะพ ะฟัะพะณัะฐะผะผะฐ. ะัะพะณัะฐะผะผะฐ โ ััะพ ัะฐะนะป ะฝะฐ ะดะธัะบะต (ะธัะฟะพะปะฝัะตะผัะน ะบะพะด). ะัะพัะตัั โ ััะพ ะฟัะพะณัะฐะผะผะฐ ะฒ ะฒัะฟะพะปะฝะตะฝะธะธ: ะบะพะด, ะทะฐะณััะถะตะฝะฝัะน ะฒ ะฟะฐะผััั, ะฟะปัั ัะตะบััะตะต ัะพััะพัะฝะธะต (ัะตะณะธัััั CPU, ะพัะบััััะต ัะฐะนะปั, ะฟะตัะตะผะตะฝะฝัะต).

### ะะท ัะตะณะพ ัะพััะพะธั ะฟัะพัะตัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ะะะะฆะะกะก                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ  ะะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ (ะฒะธัััะฐะปัะฝะฐั ะฟะฐะผััั):                    โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ Stack (ัะฐัััั ะฒะฝะธะท โ)                                       โโ
โ  โ   - ะปะพะบะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต                                    โโ
โ  โ   - ะฐะดัะตัะฐ ะฒะพะทะฒัะฐัะฐ ะธะท ััะฝะบัะธะน                              โโ
โ  โ   - ะฟะฐัะฐะผะตััั ััะฝะบัะธะน                                       โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ  โ                    โ ัะฒะพะฑะพะดะฝะพ โ                             โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ  โ Heap (ัะฐัััั ะฒะฒะตัั โ)                                       โโ
โ  โ   - malloc(), new                                           โโ
โ  โ   - ะดะธะฝะฐะผะธัะตัะบะธะต ััััะบัััั ะดะฐะฝะฝัั                           โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ  โ BSS (ะฝะตะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐะฝะฝัะต ะณะปะพะฑะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต)            โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ  โ Data (ะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐะฝะฝัะต ะณะปะพะฑะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต)             โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ  โ Text (ะบะพะด ะฟัะพะณัะฐะผะผั) โ read-only                            โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                 โ
โ  ะะตะถะดั Heap ะธ Stack ะตััั ะตัั ะพะดะฝะฐ ะพะฑะปะฐััั:                      โ
โ  Memory Mapping Segment (mmap) โ ะธัะฟะพะปัะทัะตััั ะดะปั:              โ
โ    - ะะพะดะณััะทะบะธ ะดะธะฝะฐะผะธัะตัะบะธั ะฑะธะฑะปะธะพัะตะบ (.so)                     โ
โ    - Memory-mapped files                                        โ
โ    - ะะฝะพะฝะธะผะฝัั ะผะฐะฟะฟะธะฝะณะพะฒ (shared memory, ะฑััะตัั)                โ
โ    - ะกัะตะบะพะฒ ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะฟะพัะพะบะพะฒ (pthread)                    โ
โ                                                                 โ
โ  + ะะตััััั:                                                     โ
โ    - ะัะบััััะต ัะฐะนะปั (file descriptors)                          โ
โ    - ะกะตัะตะฒัะต ัะพะตะดะธะฝะตะฝะธั                                         โ
โ    - ะัะฐะฒะฐ ะดะพัััะฟะฐ                                              โ
โ    - ะขะตะบััะฐั ะดะธัะตะบัะพัะธั                                         โ
โ                                                                 โ
โ  + ะกะพััะพัะฝะธะต:                                                   โ
โ    - ะะตะณะธัััั CPU                                               โ
โ    - Program Counter (ัะบะฐะทะฐัะตะปั ะฝะฐ ัะตะบัััั ะธะฝััััะบัะธั)          โ
โ    - Stack Pointer                                              โ
โ                                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Process Control Block (PCB)

ะฏะดัะพ ััะฐะฝะธั ะธะฝัะพัะผะฐัะธั ะพ ะบะฐะถะดะพะผ ะฟัะพัะตััะต ะฒ ััััะบัััะต PCB:

```c
// ะฃะฟัะพััะฝะฝะฐั ััััะบัััะฐ PCB (ัะตะฐะปัะฝะฐั ะฒ Linux โ task_struct)
struct PCB {
    int pid;                    // Process ID
    int state;                  // Running, Ready, Blocked, etc.
    int priority;               // ะัะธะพัะธัะตั ะดะปั ะฟะปะฐะฝะธัะพะฒัะธะบะฐ

    // ะะพะฝัะตะบัั CPU (ัะพััะฐะฝัะตััั ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ)
    registers_t registers;      // ะัะต ัะตะณะธัััั CPU
    void* program_counter;      // ะขะตะบััะฐั ะธะฝััััะบัะธั
    void* stack_pointer;        // ะะตัั ััะตะบะฐ

    // ะะฐะผััั
    page_table_t* page_table;   // ะขะฐะฑะปะธัะฐ ัััะฐะฝะธั

    // ะะตััััั
    file_descriptor_t* open_files[MAX_FILES];

    // ะกะฒัะทะธ
    struct PCB* parent;         // ะะพะดะธัะตะปััะบะธะน ะฟัะพัะตัั
    struct PCB* children;       // ะะพัะตัะฝะธะต ะฟัะพัะตััั
};
```

### ะกะพััะพัะฝะธั ะฟัะพัะตััะฐ

ะัะพัะตัั ะฟัะพัะพะดะธั ัะตัะตะท ะฝะตัะบะพะปัะบะพ ัะพััะพัะฝะธะน:

```
                    โโโโโโโโโโโโโโโโโโโโ
                    โ      New         โ
                    โ  (ัะพะทะดะฐัััั)     โ
                    โโโโโโโโโโฌโโโโโโโโโโ
                             โ admitted
                             โผ
โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
โ     Blocked      โโโโโโ      Ready       โโโโโโ     Running      โ
โ  (ะถะดัั ัะพะฑััะธะต)  โ    โ (ะณะพัะพะฒ ะบ ัะฐะฑะพัะต) โ    โ  (ะฒัะฟะพะปะฝัะตััั)   โ
โโโโโโโโโโฌโโโโโโโโโโ    โโโโโโโโโโฌโโโโโโโโโโ    โโโโโโโโโโฌโโโโโโโโโโ
         โ                       โ                       โ
         โ event occurred        โ scheduled             โ preempted
         โโโโโโโโโโโโโโโโโโโโโโโโถโโโโโโโโโโโโโโโโโโโโโโโโโ
                                 โ
                                 โ exit
                                 โผ
                    โโโโโโโโโโโโโโโโโโโโ
                    โ   Terminated     โ
                    โ   (ะทะฐะฒะตัััะฝ)     โ
                    โโโโโโโโโโโโโโโโโโโโ
```

**Ready:** ะัะพัะตัั ะณะพัะพะฒ ะฒัะฟะพะปะฝััััั, ะฝะพ CPU ะทะฐะฝัั ะดััะณะธะผ ะฟัะพัะตััะพะผ. ะะดัั ัะฒะพะตะน ะพัะตัะตะดะธ ะฒ ready queue.

**Running:** ะัะพัะตัั ะฒัะฟะพะปะฝัะตััั ะฝะฐ CPU. ะ ะพะดะฝะพะฟัะพัะตััะพัะฝะพะน ัะธััะตะผะต ัะพะปัะบะพ ะพะดะธะฝ ะฟัะพัะตัั ะผะพะถะตั ะฑััั ะฒ ััะพะผ ัะพััะพัะฝะธะธ.

**Blocked (Waiting):** ะัะพัะตัั ะถะดัั ะบะฐะบะพะณะพ-ัะพ ัะพะฑััะธั โ ะทะฐะฒะตััะตะฝะธั I/O ะพะฟะตัะฐัะธะธ, ะพัะฒะพะฑะพะถะดะตะฝะธั ัะตััััะฐ, ัะธะณะฝะฐะปะฐ. ะะพะบะฐ ัะพะฑััะธะต ะฝะต ะฟัะพะธะทะพะนะดัั, ะฟัะพัะตััั ะฑะตััะผััะปะตะฝะฝะพ ะดะฐะฒะฐัั CPU.

### Zombie ะธ Orphan ะฟัะพัะตััั

**Zombie (defunct) ะฟัะพัะตัั** โ ััะพ ะฟัะพัะตัั, ะบะพัะพััะน ะทะฐะฒะตััะธะป ะฒัะฟะพะปะฝะตะฝะธะต, ะฝะพ ะตะณะพ ะทะฐะฟะธัั ะฒัั ะตัั ะพััะฐัััั ะฒ ัะฐะฑะปะธัะต ะฟัะพัะตััะพะฒ. ะะพัะตะผั ัะฐะบ ะฟัะพะธััะพะดะธั? ะะพะณะดะฐ ะฟัะพัะตัั ะทะฐะฒะตััะฐะตััั ัะตัะตะท `exit()`, ัะดัะพ ัะพััะฐะฝัะตั ะธะฝัะพัะผะฐัะธั ะพ ะฝัะผ (exit status, ะธัะฟะพะปัะทะพะฒะฐะฝะฝะพะต CPU ะฒัะตะผั), ััะพะฑั ัะพะดะธัะตะปััะบะธะน ะฟัะพัะตัั ะผะพะณ ะตั ะฟะพะปััะธัั ัะตัะตะท `wait()` ะธะปะธ `waitpid()`. ะะพะบะฐ ัะพะดะธัะตะปั ะฝะต ะฒัะทะพะฒะตั `wait()`, ะฟัะพัะตัั ะพััะฐัััั zombie.

Zombie ะฟัะพัะตััั ะฝะต ะฟะพััะตะฑะปััั ะฟะฐะผััั ะธะปะธ CPU โ ะพะฝะธ ะทะฐะฝะธะผะฐัั ัะพะปัะบะพ ัััะพะบั ะฒ ัะฐะฑะปะธัะต ะฟัะพัะตััะพะฒ. ะะพ ัะฐะฑะปะธัะฐ ะฟัะพัะตััะพะฒ ะบะพะฝะตัะฝะฐ. ะัะปะธ ะฝะฐะบะพะฟะธััั ัะปะธัะบะพะผ ะผะฝะพะณะพ zombie, ะฝะพะฒัะต ะฟัะพัะตััั ะฝะต ัะผะพะณัั ัะพะทะดะฐะฒะฐัััั.

```c
// ะกะพะทะดะฐะฝะธะต zombie: ัะพะดะธัะตะปั ะฝะต ะฒัะทัะฒะฐะตั wait()
pid_t pid = fork();
if (pid == 0) {
    // ะะตะฑัะฝะพะบ ะทะฐะฒะตััะฐะตััั ััะฐะทั
    exit(0);
}
// ะะพะดะธัะตะปั ะฝะต ะฒัะทัะฒะฐะตั wait() โ ัะตะฑัะฝะพะบ ััะฐะฝะพะฒะธััั zombie
sleep(60);  // ะ ัะตัะตะฝะธะต ััะธั 60 ัะตะบัะฝะด ัะตะฑัะฝะพะบ โ zombie
```

**Orphan ะฟัะพัะตัั** โ ััะพ ัะฐะฑะพัะฐััะธะน ะฟัะพัะตัั, ัะตะน ัะพะดะธัะตะปั ะทะฐะฒะตััะธะปัั ัะฐะฝััะต ะฝะตะณะพ. ะะพะณะดะฐ ัะพะดะธัะตะปั ัะผะธัะฐะตั, ัะดัะพ "ัััะฝะพะฒะปัะตั" orphan ะฟัะพัะตัั โ ะตะณะพ ะฝะพะฒัะผ ัะพะดะธัะตะปะตะผ ััะฐะฝะพะฒะธััั ะฟัะพัะตัั init (PID 1). ะะพะณะดะฐ orphan ะทะฐะฒะตััะธััั, init ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะทะพะฒะตั `wait()`, ะฟะพััะพะผั orphan ะฝะต ััะฐะฝัั zombie.

```c
pid_t pid = fork();
if (pid == 0) {
    // ะะตะฑัะฝะพะบ: ัะฟะธั, ะฟะพะบะฐ ัะพะดะธัะตะปั ะฝะต ัะผััั
    sleep(10);
    // ะะพัะปะต ัะผะตััะธ ัะพะดะธัะตะปั getppid() ะฒะตัะฝัั 1 (init)
    printf("ะะพะน ะฝะพะฒัะน ัะพะดะธัะตะปั: %d\n", getppid());  // ะัะฒะตะดะตั 1
    exit(0);
}
// ะะพะดะธัะตะปั ะทะฐะฒะตััะฐะตััั ััะฐะทั โ ัะตะฑัะฝะพะบ ััะฐะฝะพะฒะธััั orphan
exit(0);
```

**ะะฐะบ ะฟัะตะดะพัะฒัะฐัะธัั zombie:**
1. ะัะตะณะดะฐ ะฒัะทัะฒะฐัั `wait()` ะธะปะธ `waitpid()` ะดะปั ะดะพัะตัะฝะธั ะฟัะพัะตััะพะฒ
2. ะัะฟะพะปัะทะพะฒะฐัั signal handler ะดะปั SIGCHLD, ะบะพัะพััะน ะฒัะทัะฒะฐะตั `wait()`
3. ะัะฟะพะปัะทะพะฒะฐัั ะดะฒะพะนะฝะพะน fork (ัะตะฑัะฝะพะบ ััะฐะทั ะทะฐะฒะตััะฐะตััั, ะฒะฝัะบ ัััะฝะพะฒะปัะตััั init)

---

## ะงัะพ ัะฐะบะพะต ะฟะพัะพะบ (Thread)

ะะพัะพะบ โ ััะพ "ะปะตะณะบะพะฒะตัะฝัะน ะฟัะพัะตัั" ะฒะฝัััะธ ะฟัะพัะตััะฐ. ะัะต ะฟะพัะพะบะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ ัะฐะทะดะตะปััั:
- ะะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ (ะบะพะด, heap, ะณะปะพะฑะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต)
- ะัะบััััะต ัะฐะนะปั
- ะััะณะธะต ัะตััััั ะฟัะพัะตััะฐ

ะฃ ะบะฐะถะดะพะณะพ ะฟะพัะพะบะฐ ัะพะฑััะฒะตะฝะฝัะต:
- Stack (ััะตะบ ะฒัะทะพะฒะพะฒ)
- ะะตะณะธัััั CPU
- Program Counter
- Thread-local storage (TLS)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ะะะะฆะะกะก                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ  ะะฑัะฐั ะฟะฐะผััั (ะฒัะต ะฟะพัะพะบะธ ะฒะธะดัั):                               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ Heap            โ Data            โ Text (ะบะพะด)              โโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                 โ
โ  ะะพัะพะบะธ:                                                        โ
โ  โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ            โ
โ  โ   Thread 1   โ โ   Thread 2   โ โ   Thread 3   โ            โ
โ  โ              โ โ              โ โ              โ            โ
โ  โ Stack        โ โ Stack        โ โ Stack        โ            โ
โ  โ Registers    โ โ Registers    โ โ Registers    โ            โ
โ  โ PC           โ โ PC           โ โ PC           โ            โ
โ  โ TLS          โ โ TLS          โ โ TLS          โ            โ
โ  โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ            โ
โ                                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะพัะตะผั ะฟะพัะพะบะธ ัััะตะบัะธะฒะฝะตะต ะฟัะพัะตััะพะฒ ะดะปั ะฟะฐัะฐะปะปะตะปะธะทะผะฐ

**ะกะพะทะดะฐะฝะธะต:** ะกะพะทะดะฐะฝะธะต ะฟะพัะพะบะฐ ะทะฝะฐัะธัะตะปัะฝะพ ะฑััััะตะต ัะพะทะดะฐะฝะธั ะฟัะพัะตััะฐ. fork() ั COW ะทะฐะฝะธะผะฐะตั ~100-300ยตs, pthread_create โ ~30-50ยตs. ะะฐะทะฝะธัะฐ ัะผะตะฝััะธะปะฐัั ะฑะปะฐะณะพะดะฐัั Copy-on-Write, ะฝะพ ะฟะพัะพะบ ะฒัั ัะฐะฒะฝะพ ะฑััััะตะต: ะฝะต ะฝัะถะฝะพ ะบะพะฟะธัะพะฒะฐัั page tables ะธ ะฒัะดะตะปััั ะฝะพะฒัะต ัะตััััั.

**ะะฐะผััั:** ะะพัะพะบะธ ัะฐะทะดะตะปััั heap. ะัะพัะตััั ะธะทะพะปะธัะพะฒะฐะฝั โ ะดะปั ะพะฑะผะตะฝะฐ ะดะฐะฝะฝัะผะธ ะฝัะถะฝั ัะฟะตัะธะฐะปัะฝัะต ะผะตัะฐะฝะธะทะผั IPC (pipes, shared memory, sockets), ะบะพัะพััะต ััะตะฑััั ะบะพะฟะธัะพะฒะฐะฝะธั ะดะฐะฝะฝัั ะธะปะธ syscalls.

**ะะตัะตะบะปััะตะฝะธะต:** Context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ ะฑััััะตะต, ัะตะผ ะผะตะถะดั ะฟัะพัะตััะฐะผะธ. ะัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะผะตะถะดั ะฟัะพัะตััะฐะผะธ ะฝัะถะฝะพ:
- ะกะผะตะฝะธัั page table (ัะตะณะธััั CR3 ะฝะฐ x86)
- ะกะฑัะพัะธัั TLB (Translation Lookaside Buffer) โ ะบัั ััะฐะฝัะปััะธะธ ะฐะดัะตัะพะฒ
- ะะฐ ะฝะตะบะพัะพััั ะฐััะธัะตะบัััะฐั (ARM) โ ัะฑัะพัะธัั L1 ะบัั ะฟะพะปะฝะพัััั!

ะัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ ะฝะต ะผะตะฝัะตััั, ะฟะพััะพะผั TLB ะพััะฐัััั ะฒะฐะปะธะดะฝัะผ. ะะพ ะธะทะผะตัะตะฝะธัะผ, context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะทะฐะฝะธะผะฐะตั 1.2-1.5 ะผะธะบัะพัะตะบัะฝะดั ะฝะฐ ะพะดะฝะพะผ ัะดัะต, ะผะตะถะดั ะฟัะพัะตััะฐะผะธ โ ะดะพ 2.2 ะผะธะบัะพัะตะบัะฝะดั ะธ ะฑะพะปะตะต ะธะท-ะทะฐ TLB miss ะฟะพัะปะต ะฟะตัะตะบะปััะตะฝะธั.

### ะะพัะตะผั ะฟะพัะพะบะธ ะพะฟะฐัะฝั

ะะฐะทะดะตะปัะตะผะฐั ะฟะฐะผััั โ ััะพ ะธ ะฟัะตะธะผััะตััะฒะพ, ะธ ะธััะพัะฝะธะบ ะฟัะพะฑะปะตะผ:

```c
// ะะฒะฐ ะฟะพัะพะบะฐ ะฒัะฟะพะปะฝััั ััะพั ะบะพะด ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
int counter = 0;  // ะะฑัะฐั ะฟะตัะตะผะตะฝะฝะฐั

void increment() {
    counter++;  // ะัะณะปัะดะธั ะฐัะพะผะฐัะฝะพ, ะฝะพ ััะพ 3 ะพะฟะตัะฐัะธะธ:
                // 1. ะัะพัะธัะฐัั counter ะฒ ัะตะณะธััั
                // 2. ะฃะฒะตะปะธัะธัั ัะตะณะธััั
                // 3. ะะฐะฟะธัะฐัั ัะตะณะธััั ะพะฑัะฐัะฝะพ ะฒ counter
}

// ะะพะทะผะพะถะฝัะน ััะตะฝะฐัะธะน:
// Thread 1: ัะธัะฐะตั counter (0)
// Thread 2: ัะธัะฐะตั counter (0)
// Thread 1: ัะฒะตะปะธัะธะฒะฐะตั (1)
// Thread 2: ัะฒะตะปะธัะธะฒะฐะตั (1)
// Thread 1: ะทะฐะฟะธััะฒะฐะตั (1)
// Thread 2: ะทะฐะฟะธััะฒะฐะตั (1)
// ะะตะทัะปััะฐั: 1 ะฒะผะตััะพ 2 โ race condition!
```

ะะพะดัะพะฑะฝะตะต ะพ ัะธะฝััะพะฝะธะทะฐัะธะธ โ ะฒ [[os-synchronization]].

---

## ะกะพะทะดะฐะฝะธะต ะฟัะพัะตััะพะฒ: fork() ะธ exec()

ะ Unix-ัะธััะตะผะฐั ะฟัะพัะตััั ัะพะทะดะฐัััั ัะตัะตะท ะบะพะผะฑะธะฝะฐัะธั ะดะฒัั syscalls:

### fork() โ ะบะปะพะฝะธัะพะฒะฐะฝะธะต ะฟัะพัะตััะฐ

`fork()` ัะพะทะดะฐัั ัะพัะฝัั ะบะพะฟะธั ัะตะบััะตะณะพ ะฟัะพัะตััะฐ:

```c
#include <stdio.h>
#include <unistd.h>

int main() {
    printf("ะะตัะตะด fork: PID = %d\n", getpid());

    pid_t pid = fork();  // ะะดะตัั ะฟัะพัะตัั ัะฐะทะดะฒะฐะธะฒะฐะตััั

    if (pid < 0) {
        // ะัะธะฑะบะฐ
        perror("fork failed");
    } else if (pid == 0) {
        // ะญัะพ ะดะพัะตัะฝะธะน ะฟัะพัะตัั (fork ะฒะตัะฝัะป 0)
        printf("ะะพัะตัะฝะธะน ะฟัะพัะตัั: PID = %d, ัะพะดะธัะตะปั = %d\n",
               getpid(), getppid());
    } else {
        // ะญัะพ ัะพะดะธัะตะปััะบะธะน ะฟัะพัะตัั (fork ะฒะตัะฝัะป PID ัะตะฑัะฝะบะฐ)
        printf("ะะพะดะธัะตะปััะบะธะน ะฟัะพัะตัั: PID = %d, ัะตะฑัะฝะพะบ = %d\n",
               getpid(), pid);
    }

    return 0;
}

// ะัะฒะพะด:
// ะะตัะตะด fork: PID = 1234
// ะะพะดะธัะตะปััะบะธะน ะฟัะพัะตัั: PID = 1234, ัะตะฑัะฝะพะบ = 1235
// ะะพัะตัะฝะธะน ะฟัะพัะตัั: PID = 1235, ัะพะดะธัะตะปั = 1234
```

**ะงัะพ ะบะพะฟะธััะตััั ะฟัะธ fork():**
- ะัั ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ (ะฝะพ ั Copy-on-Write ะพะฟัะธะผะธะทะฐัะธะตะน)
- ะัะบััััะต ัะฐะนะปั
- ะกะธะณะฝะฐะปั
- ะขะตะบััะฐั ะดะธัะตะบัะพัะธั

**Copy-on-Write (COW):** ะกะพะฒัะตะผะตะฝะฝัะต ะะก ะฝะต ะบะพะฟะธัััั ะฟะฐะผััั ััะฐะทั. ะะพะดะธัะตะปั ะธ ัะตะฑัะฝะพะบ ัะฐะทะดะตะปััั ะพะดะฝะธ ัััะฐะฝะธัั ะฟะฐะผััะธ (read-only). ะะพะฟะธั ัะพะทะดะฐัััั ัะพะปัะบะพ ะบะพะณะดะฐ ะพะดะธะฝ ะธะท ะฝะธั ะฟััะฐะตััั ะทะฐะฟะธัะฐัั โ ัะพะณะดะฐ ะบะพะฟะธััะตััั ัะพะปัะบะพ ะธะทะผะตะฝัะฝะฝะฐั ัััะฐะฝะธัะฐ. ะญัะพ ะดะตะปะฐะตั fork() ะฑัััััะผ ะดะฐะถะต ะดะปั ะฟัะพัะตััะพะฒ ั ะฑะพะปััะธะผ heap.

### exec() โ ะทะฐะผะตะฝะฐ ะพะฑัะฐะทะฐ ะฟัะพัะตััะฐ

`exec()` ะทะฐะผะตะฝัะตั ัะตะบัััั ะฟัะพะณัะฐะผะผั ะฝะพะฒะพะน:

```c
#include <unistd.h>

int main() {
    printf("ะกะตะนัะฐั ั ะฟัะพะณัะฐะผะผะฐ A\n");

    // ะะฐะผะตะฝะธัั ัะตะฑั ะฝะฐ /bin/ls
    execl("/bin/ls", "ls", "-la", NULL);

    // ะญัะพั ะบะพะด ะะ ะฒัะฟะพะปะฝะธััั, ะตัะปะธ exec ััะฟะตัะตะฝ
    printf("ะญัะพ ะฝะธะบะพะณะดะฐ ะฝะต ะฝะฐะฟะตัะฐัะฐะตััั\n");

    return 0;
}
```

### ะขะธะฟะธัะฝัะน ะฟะฐััะตัะฝ: fork + exec

```c
pid_t pid = fork();

if (pid == 0) {
    // ะะพัะตัะฝะธะน ะฟัะพัะตัั โ ะทะฐะฟัััะธัั ะดััะณัั ะฟัะพะณัะฐะผะผั
    execl("/bin/ls", "ls", "-la", NULL);
    exit(1);  // ะกัะดะฐ ะฟะพะฟะฐะดัะผ ัะพะปัะบะพ ะตัะปะธ exec ะฝะตัะดะฐัะตะฝ
}

// ะะพะดะธัะตะปั ะถะดัั ะทะฐะฒะตััะตะฝะธั ัะตะฑัะฝะบะฐ
int status;
waitpid(pid, &status, 0);
printf("ะะตะฑัะฝะพะบ ะทะฐะฒะตััะธะปัั ั ะบะพะดะพะผ %d\n", WEXITSTATUS(status));
```

ะขะฐะบ ัะฐะฑะพัะฐะตั shell: ะบะพะณะดะฐ ะฒั ะฒะฒะพะดะธัะต ะบะพะผะฐะฝะดั, shell ะดะตะปะฐะตั fork(), ะฒ ะดะพัะตัะฝะตะผ ะฟัะพัะตััะต exec() ะทะฐะฟััะบะฐะตั ะบะพะผะฐะฝะดั, ะฐ ัะพะดะธัะตะปั wait() ะถะดัั ะทะฐะฒะตััะตะฝะธั.

---

## ะกะพะทะดะฐะฝะธะต ะฟะพัะพะบะพะฒ: POSIX Threads (pthreads)

```c
#include <pthread.h>
#include <stdio.h>

void* thread_function(void* arg) {
    int thread_num = *(int*)arg;
    printf("ะะพัะพะบ %d ะฒัะฟะพะปะฝัะตััั\n", thread_num);
    return NULL;
}

int main() {
    pthread_t threads[3];
    int thread_args[3] = {1, 2, 3};

    // ะกะพะทะดะฐัั 3 ะฟะพัะพะบะฐ
    for (int i = 0; i < 3; i++) {
        pthread_create(&threads[i], NULL, thread_function, &thread_args[i]);
    }

    // ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั ะฒัะตั ะฟะพัะพะบะพะฒ
    for (int i = 0; i < 3; i++) {
        pthread_join(threads[i], NULL);
    }

    printf("ะัะต ะฟะพัะพะบะธ ะทะฐะฒะตััะธะปะธัั\n");
    return 0;
}
```

### ะะฐะทะผะตั ััะตะบะฐ ะฟะพัะพะบะฐ

ะะพ ัะผะพะปัะฐะฝะธั ะฝะฐ Linux ะบะฐะถะดัะน ะฟะพัะพะบ ะฟะพะปััะฐะตั ััะตะบ ัะฐะทะผะตัะพะผ **8 MB** ะฒะธัััะฐะปัะฝะพะน ะฟะฐะผััะธ. ะญัะพ ะฝะต ะพะทะฝะฐัะฐะตั, ััะพ ััะฐะทั ะฒัะดะตะปัะตััั 8 MB ัะธะทะธัะตัะบะพะน ะฟะฐะผััะธ โ ัััะฐะฝะธัั ะฒัะดะตะปััััั ะฟะพ ััะตะฑะพะฒะฐะฝะธั (demand paging).

ะะพ ะตัะปะธ ั ะฒะฐั 10,000 ะฟะพัะพะบะพะฒ, ััะพ 80 GB ะฒะธัััะฐะปัะฝะพะณะพ ะฐะดัะตัะฝะพะณะพ ะฟัะพัััะฐะฝััะฒะฐ ัะพะปัะบะพ ะฟะพะด ััะตะบะธ. ะะตะฐะปัะฝะพะต ะฟะพััะตะฑะปะตะฝะธะต ะฟะฐะผััะธ ะฑัะดะตั ะผะตะฝััะต (ัะพะปัะบะพ ะธัะฟะพะปัะทะพะฒะฐะฝะฝัะต ัััะฐะฝะธัั), ะฝะพ ััะพ ะฝะฐะบะปะฐะดัะฒะฐะตั ะพะณัะฐะฝะธัะตะฝะธั.

```c
// ะฃะผะตะฝััะธัั ัะฐะทะผะตั ััะตะบะฐ ะฟะพัะพะบะฐ
pthread_attr_t attr;
pthread_attr_init(&attr);
pthread_attr_setstacksize(&attr, 64 * 1024);  // 64 KB ะฒะผะตััะพ 8 MB

pthread_t thread;
pthread_create(&thread, &attr, thread_function, NULL);
```

---

## ะัะพัะตััั vs ะะพัะพะบะธ: ะบะพะณะดะฐ ััะพ ะธัะฟะพะปัะทะพะฒะฐัั

### ะัะฟะพะปัะทัะนัะต ะฟัะพัะตััั ะบะพะณะดะฐ:

**ะัะถะฝะฐ ะธะทะพะปััะธั.** ะัะปะธ ะพะดะธะฝ ะบะพะผะฟะพะฝะตะฝั ะผะพะถะตั ัะฟะฐััั ะธะปะธ ะทะฐะฒะธัะฝััั, ะพะฝ ะฝะต ะดะพะปะถะตะฝ ััะพะฝะธัั ะฒัั ัะธััะตะผั. Chrome ะธัะฟะพะปัะทัะตั ะพัะดะตะปัะฝัะน ะฟัะพัะตัั ะดะปั ะบะฐะถะดะพะน ะฒะบะปะฐะดะบะธ โ ะฟะฐะดะตะฝะธะต ะพะดะฝะพะน ะฒะบะปะฐะดะบะธ ะฝะต ัะพะฝัะตั ะฑัะฐัะทะตั.

**ะัะถะฝะฐ ะฑะตะทะพะฟะฐัะฝะพััั.** ะัะพัะตััั ะธะทะพะปะธัะพะฒะฐะฝั โ ะพะดะธะฝ ะฟัะพัะตัั ะฝะต ะผะพะถะตั ัะธัะฐัั ะฟะฐะผััั ะดััะณะพะณะพ (ะฑะตะท ัะฒะฝะพะณะพ ัะฐะทัะตัะตะฝะธั). ะะตัะพัะฝะธัะฐ ะดะปั ะฝะตะดะพะฒะตัะตะฝะฝะพะณะพ ะบะพะดะฐ โ ััะพ ะพัะดะตะปัะฝัะน ะฟัะพัะตัั.

**ะะฐะทะฝัะต ัะทัะบะธ/ัะฐะฝัะฐะนะผั.** ะะธะบัะพัะตัะฒะธัั ะฝะฐ ัะฐะทะฝัั ัะทัะบะฐั โ ััะพ ัะฐะทะฝัะต ะฟัะพัะตััั, ะพะฑัะฐััะธะตัั ะฟะพ ัะตัะธ.

### ะัะฟะพะปัะทัะนัะต ะฟะพัะพะบะธ ะบะพะณะดะฐ:

**ะัะถะฝะฐ ะพะฑัะฐั ะฟะฐะผััั.** ะะพัะพะบะธ ัััะตะบัะธะฒะฝะพ ัะฐะทะดะตะปััั ะดะฐะฝะฝัะต ะฑะตะท ะบะพะฟะธัะพะฒะฐะฝะธั. Web-ัะตัะฒะตั ั thread-per-request ะผะพะถะตั ััะฐะฝะธัั ะบัั ะฒ ะฟะฐะผััะธ, ะดะพัััะฟะฝัะน ะฒัะตะผ ะฟะพัะพะบะฐะผ.

**ะัะถะฝะพ ะผะฝะพะณะพ ะฟะฐัะฐะปะปะตะปัะฝัั ะทะฐะดะฐั.** 10,000 ะฟะพัะพะบะพะฒ ัะพะทะดะฐัััั ะทะฐ ัะตะบัะฝะดั; 10,000 ะฟัะพัะตััะพะฒ โ ะทะฐ ะผะธะฝััั.

**Latency ะบัะธัะธัะฝะฐ.** Context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะฑััััะตะต.

### ะกัะฐะฒะฝะตะฝะธะต

| ะัะธัะตัะธะน | ะัะพัะตััั | ะะพัะพะบะธ |
|----------|----------|--------|
| ะกะพะทะดะฐะฝะธะต (fork/pthread) | ~100-300ยตs | ~30-50ยตs |
| ะะฐะผััั | ะะทะพะปะธัะพะฒะฐะฝะฐ | ะะฐะทะดะตะปัะตะผะฐั |
| ะะพะผะผัะฝะธะบะฐัะธั | IPC (ะผะตะดะปะตะฝะฝะพ) | ะะฑัะฐั ะฟะฐะผััั (ะฑััััะพ) |
| ะัะบะฐะทะพัััะพะนัะธะฒะพััั | ะััะพะบะฐั (ะธะทะพะปััะธั) | ะะธะทะบะฐั (ะพะดะธะฝ ัะฟะฐะป โ ะฒัะต ัะฟะฐะปะธ) |
| Context switch | ะะตะดะปะตะฝะฝัะน (TLB flush) | ะัััััะน |
| ะกะธะฝััะพะฝะธะทะฐัะธั | ะะต ะฝัะถะฝะฐ (ะธะทะพะปััะธั) | ะะฑัะทะฐัะตะปัะฝะฐ (race conditions) |

---

## ะะพะณะดะฐ ะะ ะธัะฟะพะปัะทะพะฒะฐัั ะผะฝะพะณะพะฟะพัะพัะฝะพััั

ะะฝะพะณะพะฟะพัะพัะฝะพััั โ ะฝะต ัะตัะตะฑััะฝะฐั ะฟัะปั. ะะฝะพะณะดะฐ ะพะฝะฐ ััะปะพะถะฝัะตั ะบะพะด ะฑะตะท ัะตะฐะปัะฝะพะณะพ ะฒัะธะณัััะฐ.

### ะกะธััะฐัะธะธ ะณะดะต ะผะฝะพะณะพะฟะพัะพัะฝะพััั ะะ ะฟะพะผะพะถะตั

**1. CPU-bound ะทะฐะดะฐัะฐ ะฝะฐ ะพะดะฝะพะผ ัะดัะต:**
```
โ 4 ะฟะพัะพะบะฐ ะฝะฐ 1 ัะดัะต = context switch overhead + ัะต ะถะต ะฒััะธัะปะตะฝะธั
โ 1 ะฟะพัะพะบ = ะฝะธะบะฐะบะพะณะพ overhead
```
ะะฝะพะณะพะฟะพัะพัะฝะพััั ััะบะพััะตั CPU-bound ะทะฐะดะฐัะธ ัะพะปัะบะพ ะตัะปะธ ะตััั ัะฒะพะฑะพะดะฝัะต ัะดัะฐ.

**2. I/O-bound ะทะฐะดะฐัะฐ ะฑะตะท ะฟะฐัะฐะปะปะตะปัะฝัั ะทะฐะฟัะพัะพะฒ:**
```
โ 1 ะฟะพัะพะบ ัะธัะฐะตั ัะฐะนะป โ 2 ะฟะพัะพะบะฐ ะฝะต ััะบะพััั ััะตะฝะธะต ั ะพะดะฝะพะณะพ ะดะธัะบะฐ
โ Async I/O ะฝะฐ 1 ะฟะพัะพะบะต = ะผะตะฝััะต ะฟะฐะผััะธ, ัะพั ะถะต ัะตะทัะปััะฐั
```

**3. ะัะพััะฐั ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะฐั ะปะพะณะธะบะฐ:**
```
โ parse โ validate โ save: 3 ะฟะพัะพะบะฐ ั ัะธะฝััะพะฝะธะทะฐัะธะตะน
โ ะะพัะปะตะดะพะฒะฐัะตะปัะฝัะน ะบะพะด: ะฟัะพัะต, ะฑััััะตะต, ะฝะฐะดัะถะฝะตะต
```

### ะัะธะทะฝะฐะบะธ ะฝะตะฟัะฐะฒะธะปัะฝะพะณะพ ะฟัะธะผะตะฝะตะฝะธั

| ะกะธะผะฟัะพะผ | ะะตัะพััะฝะฐั ะฟัะพะฑะปะตะผะฐ |
|---------|-------------------|
| ะะพะด ัะปะพะถะฝะตะต, ะฝะพ ะฝะต ะฑััััะตะต | Overhead > benefit |
| ะะพััะพัะฝะฝัะต deadlock/race conditions | ะััะธัะตะบัััะฐ ััะตะฑัะตั ะฟะตัะตัะผะพััะฐ |
| 1000 ะฟะพัะพะบะพะฒ, ะฝะพ 4 ัะดัะฐ | ะะพัะพะบะธ = ะฝะต ัะตัะตะฝะธะต |
| Lock contention >30% ะฒัะตะผะตะฝะธ | ะะฐะฝะฝัะต ะฝะฐะดะพ ัะฐะทะดะตะปะธัั ะธะฝะฐัะต |

### ะะปััะตัะฝะฐัะธะฒั ะผะฝะพะณะพะฟะพัะพัะฝะพััะธ

| ะะผะตััะพ | ะะพะฟัะพะฑัะน |
|--------|----------|
| Thread per request | Event loop (Node.js, Netty) |
| ะะฝะพะณะพ OS threads | Coroutines / Green threads |
| Shared mutable state | Message passing (Actors, channels) |
| Lock everything | Lock-free structures / immutable data |

---

## ะะพะดะตะปะธ ะผะฝะพะณะพะฟะพัะพัะฝะพััะธ

### User-level threads vs Kernel threads

**Kernel threads:** ะะก ะทะฝะฐะตั ะพ ะบะฐะถะดะพะผ ะฟะพัะพะบะต ะธ ะฟะปะฐะฝะธััะตั ะธั. ะญัะพ ัะพ, ััะพ ะธัะฟะพะปัะทััั ะฑะพะปััะธะฝััะฒะพ ัะพะฒัะตะผะตะฝะฝัั ะฟัะธะปะพะถะตะฝะธะน.

**User-level threads:** ะะพัะพะบะธ ัะฟัะฐะฒะปััััั ะฑะธะฑะปะธะพัะตะบะพะน ะฒ user space. ะะก ะฒะธะดะธั ัะพะปัะบะพ ะพะดะธะฝ ะฟัะพัะตัั. ะัะตะธะผััะตััะฒะพ โ ะฑััััะพะต ัะพะทะดะฐะฝะธะต ะธ ะฟะตัะตะบะปััะตะฝะธะต (ะฝะตั syscalls). ะะตะดะพััะฐัะพะบ โ ะตัะปะธ ะพะดะธะฝ user thread ะทะฐะฑะปะพะบะธััะตััั ะฝะฐ syscall, ะทะฐะฑะปะพะบะธัััััั ะฒัะต.

### ะะพะดะตะปะธ ะพัะพะฑัะฐะถะตะฝะธั

```
1:1 (One-to-One)          M:1 (Many-to-One)       M:N (Many-to-Many)

User      Kernel          User      Kernel        User      Kernel
โโโ  โโโ  โโโ             โโโ                     โโโ
โโโ       โโโ             โโโค  โโโ  โโโ           โโโค  โโโ  โโโ
โโโ  โโโ  โโโ             โโโค       โโโ           โโโค       โโโค
โโโ       โโโ             โโโค                     โโโ       โโโ
โโโ  โโโ  โโโ             โโโ                     โโโ  โโโ  โโโ
โโโ       โโโ                                     โโโ       โโโ

Linux, Windows            Green Threads           Go goroutines
ะัะพััะฐั ะผะพะดะตะปั            ะััััะพ, ะฝะพ ะฑะปะพะบะธััะตั    ะะฐะปะฐะฝั
```

**1:1 (Linux, Windows):** ะะฐะถะดัะน user thread = ะพะดะธะฝ kernel thread. ะัะพััะฐั ะผะพะดะตะปั, ะฝะพ ัะพะทะดะฐะฝะธะต ะฟะพัะพะบะฐ ััะตะฑัะตั syscall.

**M:1 (Green threads):** ะะฝะพะณะพ user threads ะฝะฐ ะพะดะฝะพะผ kernel thread. ะัะตะฝั ะฑััััะพะต ัะพะทะดะฐะฝะธะต, ะฝะพ ะตัะปะธ ะพะดะธะฝ ะฟะพัะพะบ ะดะตะปะฐะตั blocking syscall โ ะฒัะต ะถะดัั.

**M:N (Go goroutines, Erlang):** ะะฝะพะณะพ user threads ัะฐัะฟัะตะดะตะปััััั ะฟะพ ะฝะตัะบะพะปัะบะธะผ kernel threads. Runtime ะฑะฐะปะฐะฝัะธััะตั ะฝะฐะณััะทะบั ะธ ะพะฑัะพะดะธั blocking syscalls.

---

## ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั ะฒ JVM ะธ Kotlin

### JVM Threads = OS Threads (1:1)

ะ HotSpot JVM ะบะฐะถะดัะน `java.lang.Thread` โ ััะพ ะพัะดะตะปัะฝัะน OS thread:

```java
// ะกะพะทะดะฐะฝะธะต Java thread = ัะพะทะดะฐะฝะธะต OS thread
Thread thread = new Thread(() -> {
    System.out.println("ะัะฟะพะปะฝัะตััั ะฒ OS thread");
});
thread.start();  // pthread_create() ะฟะพะด ะบะฐะฟะพัะพะผ
```

ะะพััะพะผั ัะพะทะดะฐะฝะธะต 10,000 Java threads = ัะพะทะดะฐะฝะธะต 10,000 OS threads = ~80 GB ะฒะธัััะฐะปัะฝะพะน ะฟะฐะผััะธ ะฟะพะด ััะตะบะธ.

### Kotlin Coroutines = User-level concurrency

Coroutines โ ััะพ M:N ะผะพะดะตะปั:

```kotlin
// 100,000 coroutines ะฝะฐ ะฝะตัะบะพะปัะบะธั OS threads
runBlocking {
    repeat(100_000) {
        launch {
            delay(1000)  // ะะต ะฑะปะพะบะธััะตั OS thread!
            println("Coroutine $it")
        }
    }
}
```

Coroutine โ ััะพ ะฟัะพััะพ ะพะฑัะตะบั ะฒ heap (~ะฝะตัะบะพะปัะบะพ ัะพัะตะฝ ะฑะฐะนั). Dispatchers ัะฐัะฟัะตะดะตะปััั coroutines ะฟะพ ะฟัะปั OS threads. `delay()` ะฝะต ะฑะปะพะบะธััะตั OS thread โ coroutine ะฟัะธะพััะฐะฝะฐะฒะปะธะฒะฐะตััั, ะธ thread ะฒัะฟะพะปะฝัะตั ะดััะณะธะต coroutines.

ะะพะดัะพะฑะฝะตะต โ ะฒ [[kotlin-coroutines]].

---

## ะัะฐะบัะธัะตัะบะธะต ะบะพะผะฐะฝะดั Linux

```bash
# ะกะฟะธัะพะบ ะฟัะพัะตััะพะฒ
ps aux                    # ะัะต ะฟัะพัะตััั
ps -ef --forest          # ะะตัะตะฒะพ ะฟัะพัะตััะพะฒ
pstree -p                # ะะธะทัะฐะปัะฝะพะต ะดะตัะตะฒะพ ั PID

# ะกะฟะธัะพะบ ะฟะพัะพะบะพะฒ ะฟัะพัะตััะฐ
ps -T -p <pid>           # ะะพัะพะบะธ ะบะพะฝะบัะตัะฝะพะณะพ ะฟัะพัะตััะฐ
top -H -p <pid>          # ะะพัะพะบะธ ะฒ top (ะธะฝัะตัะฐะบัะธะฒะฝะพ)

# ะะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะต
cat /proc/<pid>/status   # ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั
ls /proc/<pid>/fd        # ะัะบััััะต ัะฐะนะปั
cat /proc/<pid>/maps     # ะะฐััะฐ ะฟะฐะผััะธ

# ะกะพะทะดะฐะฝะธะต ะฟัะพัะตััะพะฒ
strace -f ./program      # ะขัะฐััะธัะพะฒะบะฐ syscalls ะฒะบะปััะฐั fork/exec
```

---

## ะัะพ ะธัะฟะพะปัะทัะตั ะธ ัะตะฐะปัะฝัะต ะฟัะธะผะตัั

### ะัะฐัะทะตัั: Process-per-tab

| ะัะฐัะทะตั | ะััะธัะตะบัััะฐ | ะะพัะตะผั ัะฐะบ |
|---------|-------------|------------|
| **Google Chrome** | ะะฐะถะดะฐั ะฒะบะปะฐะดะบะฐ = ะพัะดะตะปัะฝัะน ะฟัะพัะตัั | ะะตะทะพะฟะฐัะฝะพััั + ะธะทะพะปััะธั: ะตัะปะธ ะฒะบะปะฐะดะบะฐ ัะฟะฐะดัั, ะดััะณะธะต ะฝะต ะฟะพัััะฐะดะฐัั. 10 ะฒะบะปะฐะดะพะบ = 10 ะฟัะพัะตััะพะฒ |
| **Mozilla Firefox** | 4 ะฟัะพัะตััะฐ ะบะพะฝัะตะฝัะฐ + ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะพ ะฝะตะพะฑัะพะดะธะผะพััะธ | ะะฐะปะฐะฝั ะผะตะถะดั ะฟะฐะผัััั ะธ ะธะทะพะปััะธะตะน. ะะตัะฒัะต 4 ะฒะบะปะฐะดะบะธ = 4 ะฟัะพัะตััะฐ, ะพััะฐะปัะฝัะต ะธัะฟะพะปัะทััั ะฟะพัะพะบะธ ะฒะฝัััะธ |

**ะะพัะตะผั Chrome ะธัะฟะพะปัะทัะตั ะฟัะพัะตััั, ะฐ ะฝะต ะฟะพัะพะบะธ:**
- ะะบะปะฐะดะบะฐ ั ะฒัะตะดะพะฝะพัะฝัะผ JS ะฝะต ะผะพะถะตั ะฟัะพัะธัะฐัั ะฟะฐะผััั ะดััะณะพะน ะฒะบะปะฐะดะบะธ (ะฟัะพัะตััั ะธะทะพะปะธัะพะฒะฐะฝั)
- ะะฐะฒะธััะฐั ะฒะบะปะฐะดะบะฐ ะฝะต ะฒะตัะฐะตั ะฒะตัั ะฑัะฐัะทะตั
- ะะพะถะฝะพ ัะฑะธัั ะพะดะธะฝ ะฟัะพัะตัั ะฑะตะท ะฟะพัะตัะธ ะดััะณะธั ะฒะบะปะฐะดะพะบ

**ะฆะตะฝะฐ:** Chrome ะฟะพััะตะฑะปัะตั ะฑะพะปััะต RAM, ัะตะผ Firefox (ะบะฐะถะดัะน ะฟัะพัะตัั ะธะผะตะตั overhead ~30-50MB).

### ะะฐะทั ะดะฐะฝะฝัั: Processes vs Threads

| ะกะฃะะ | ะะพะดะตะปั | ะฅะฐัะฐะบัะตัะธััะธะบะธ |
|------|--------|----------------|
| **PostgreSQL** | Process-per-connection | ะะฐะถะดะพะต ะฟะพะดะบะปััะตะฝะธะต = fork() ะฝะพะฒะพะณะพ ะฟัะพัะตััะฐ. ะะฐะดัะถะฝะพ, ะฝะพ ~100KB overhead ะฝะฐ ัะพะตะดะธะฝะตะฝะธะต. ะัััะต ะดะปั <500 ัะพะตะดะธะฝะตะฝะธะน |
| **MySQL** | Thread-per-connection | ะะฐะถะดะพะต ะฟะพะดะบะปััะตะฝะธะต = pthread. ะััััะตะต, ะผะตะฝััะต ะฟะฐะผััะธ. ะะพะถะตั ะพะฑัะฐะฑะฐััะฒะฐัั 500+ threads |
| **Oracle** | Shared Server (M:N) | ะัะป ะฟัะพัะตััะพะฒ ะพะฑัะปัะถะธะฒะฐะตั ะผะฝะพะณะพ ัะพะตะดะธะฝะตะฝะธะน. ะะฐัััะฐะฑะธััะตััั ะปัััะต |

**ะัะฐะบัะธัะตัะบะธะน ัะพะฒะตั:**
- PostgreSQL: ะธัะฟะพะปัะทัะนัะต connection pooling (PgBouncer) ะฟัะธ >100 ัะพะตะดะธะฝะตะฝะธัั
- MySQL: ะฝะฐัััะพะนัะต thread_pool ะดะปั high concurrency

### ะะพะดะตะปะธ ะผะฝะพะณะพะฟะพัะพัะฝะพััะธ ะฒ ัะทัะบะฐั

| ะฏะทัะบ/ะะปะฐััะพัะผะฐ | ะะพะดะตะปั | Thread overhead | Max practical threads |
|----------------|--------|-----------------|----------------------|
| **Java (HotSpot)** | 1:1 | ~8MB stack | ~10K |
| **Java (Loom)** | M:N virtual threads | ~ะฝะตัะบะพะปัะบะพ KB | ~1M+ |
| **Go** | M:N goroutines | ~2KB | ~1M+ |
| **Kotlin** | M:N coroutines | ~ะฝะตัะบะพะปัะบะพ ัะพัะตะฝ ะฑะฐะนั | ~1M+ |
| **Python** | 1:1 + GIL | ~8MB stack | ~100-1000 (GIL ะพะณัะฐะฝะธัะธะฒะฐะตั) |
| **Node.js** | Single-threaded event loop | 0 (1 thread) | N/A (async) |

**Benchmark ะฟัะธะผะตัั:**
- ะกะพะทะดะฐะฝะธะต OS thread (pthread): ~20-50ยตs
- ะกะพะทะดะฐะฝะธะต goroutine: ~1-20ยตs (ะฒ 10-50 ัะฐะท ะฑััััะตะต)
- ะะตัะตะบะปััะตะฝะธะต OS threads: ~5-10ยตs
- ะะตัะตะบะปััะตะฝะธะต goroutines: ~ะฝะตัะบะพะปัะบะพ ะฝะฐะฝะพัะตะบัะฝะด - 5ยตs

### ะะพะณะดะฐ ััะพ ะฒัะฑะธัะฐัั (ะฟัะฐะบัะธัะตัะบะธะต ะฟัะฐะฒะธะปะฐ)

| ะกัะตะฝะฐัะธะน | ะะตะบะพะผะตะฝะดะฐัะธั | ะะพัะตะผั |
|----------|--------------|--------|
| ะะตะฑ-ัะตัะฒะตั ั 10K+ ัะพะตะดะธะฝะตะฝะธะน | Event loop (Node.js) ะธะปะธ coroutines (Kotlin/Go) | ะะตะฝััะต overhead ะฝะฐ context switch |
| CPU-bound ะฒััะธัะปะตะฝะธั | Processes ะธะปะธ threads = ัะธัะปั ัะดะตั | ะะพะปััะต ะฟะพัะพะบะพะฒ = ัะพะปัะบะพ overhead |
| ะะทะพะปััะธั ะฝะตะฝะฐะดัะถะฝะพะณะพ ะบะพะดะฐ | ะัะดะตะปัะฝัะน ะฟัะพัะตัั (sandbox) | ะัะพัะตััั ะธะทะพะปะธัะพะฒะฐะฝั, ะฟะพัะพะบะธ โ ะฝะตั |
| ะะธะบัะพัะตัะฒะธัั ัะฐะทะฝัั ะบะพะผะฐะฝะด | ะัะดะตะปัะฝัะต ะฟัะพัะตััั (ะบะพะฝัะตะนะฝะตัั) | ะะตะทะฐะฒะธัะธะผัะน ะดะตะฟะปะพะน, ัะฐะทะฝัะต ัะทัะบะธ |
| ะะฐัะฐะปะปะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั | Thread pool ัะธะบัะธัะพะฒะฐะฝะฝะพะณะพ ัะฐะทะผะตัะฐ | ะะพะฝััะพะปั ะฝะฐะด parallelism |

---

## ะกะฒัะทั ั ะดััะณะธะผะธ ัะตะผะฐะผะธ

**[[os-overview]]** โ ะะฑะทะพั ะพะฟะตัะฐัะธะพะฝะฝัั ัะธััะตะผ ะทะฐะบะปะฐะดัะฒะฐะตั ััะฝะดะฐะผะตะฝั ะดะปั ะฟะพะฝะธะผะฐะฝะธั ะฟัะพัะตััะพะฒ ะธ ะฟะพัะพะบะพะฒ: ะบะพะฝัะตะฟัะธะธ kernel mode vs user mode ะพะฑัััะฝััั, ะฟะพัะตะผั ัะธััะตะผะฝัะต ะฒัะทะพะฒั fork() ะธ pthread_create() ะธะผะตัั ะพัััะธะผัะน overhead โ ะบะฐะถะดัะน ะธะท ะฝะธั ััะตะฑัะตั ะฟะตัะตัะพะดะฐ ะฒ ะฟัะพัััะฐะฝััะฒะพ ัะดัะฐ. ะะพะฝะธะผะฐะฝะธะต ะฐััะธัะตะบัััั ะะก (ะผะพะฝะพะปะธัะฝะพะต ัะดัะพ vs ะผะธะบัะพัะดัะพ) ะพะฟัะตะดะตะปัะตั, ะบะฐะบ ะธะผะตะฝะฝะพ ะฟัะพัะตััั ะธ ะฟะพัะพะบะธ ะพะฑัะปัะถะธะฒะฐัััั: ะฒ ะผะพะฝะพะปะธัะฝะพะผ ัะดัะต Linux ะฒัะต ะพะฟะตัะฐัะธะธ ะฟัะพะธััะพะดัั ะฒ ะตะดะธะฝะพะผ ะฐะดัะตัะฝะพะผ ะฟัะพัััะฐะฝััะฒะต ัะดัะฐ, ะฐ ะฒ ะผะธะบัะพัะดัะต Minix โ ัะตัะตะท message passing ะผะตะถะดั ัะตัะฒะตัะฝัะผะธ ะฟัะพัะตััะฐะผะธ. ะะตะท ััะพะณะพ ะบะพะฝัะตะบััะฐ ะฝะตะฒะพะทะผะพะถะฝะพ ะฟะพะฝััั, ะฟะพัะตะผั context switch ััะพะธั 2-5 ยตs ะธ ะบัะดะฐ ััะพะดะธั ััะพ ะฒัะตะผั.

**[[os-scheduling]]** โ ะะปะฐะฝะธัะพะฒะฐะฝะธะต CPU ะฝะตัะฐะทััะฒะฝะพ ัะฒัะทะฐะฝะพ ั ะฟัะพัะตััะฐะผะธ ะธ ะฟะพัะพะบะฐะผะธ, ะฟะพัะบะพะปัะบั ะธะผะตะฝะฝะพ ะฟะปะฐะฝะธัะพะฒัะธะบ ะพะฟัะตะดะตะปัะตั, ะบะฐะบะพะน ะฟะพัะพะบ ะฟะพะปััะธั ะฟัะพัะตััะพัะฝะพะต ะฒัะตะผั ะธ ะฝะฐ ะบะฐะบะพะน ััะพะบ. CFS ะฒ Linux ัะฐะฑะพัะฐะตั ั task_struct โ ัะพะน ะถะต ััััะบัััะพะน, ะบะพัะพัะฐั ะฟัะตะดััะฐะฒะปัะตั ะฟะพัะพะบ ะฒ ัะดัะต, โ ัะฐัะฟัะตะดะตะปัั vruntime ะฟัะพะฟะพััะธะพะฝะฐะปัะฝะพ ะฒะตัะฐะผ nice-ะทะฝะฐัะตะฝะธะน. ะะพะฝะธะผะฐะฝะธะต scheduling ะพะฑัััะฝัะตั, ะฟะพัะตะผั ัะพะทะดะฐะฝะธะต 1000 ะฟะพัะพะบะพะฒ ะฝะฐ 4 ัะดัะฐั ะฟัะธะฒะพะดะธั ะบ ะดะตะณัะฐะดะฐัะธะธ: overhead ะพั context switch ะธ ะบะพะฝะบััะตะฝัะธะธ ะทะฐ ะบัั-ะปะธะฝะธะธ ะฟะตัะตะฒะตัะธะฒะฐะตั ะฒัะธะณััั ะพั ะฟะฐัะฐะปะปะตะปะธะทะผะฐ. ะขะฐะบะถะต ะฟะปะฐะฝะธัะพะฒะฐะฝะธะต ะพะฟัะตะดะตะปัะตั ะฟะพะฒะตะดะตะฝะธะต ะฟัะธะพัะธัะตัะพะฒ: real-time ะฟะพัะพะบะธ (SCHED_FIFO) ะผะพะณัั ะฒััะตัะฝััั ะพะฑััะฝัะต ะฟะพัะพะบะธ CFS.

**[[os-memory-management]]** โ ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะฐะผัััั ะฝะตะฟะพััะตะดััะฒะตะฝะฝะพ ะพะฟัะตะดะตะปัะตั ััััะบัััั ะฐะดัะตัะฝะพะณะพ ะฟัะพัััะฐะฝััะฒะฐ ะฟัะพัะตััะฐ: ัะตะณะผะตะฝัั text, data, heap, stack, ะฐ ัะฐะบะถะต ะผะตัะฐะฝะธะบั page tables ะดะปั ััะฐะฝัะปััะธะธ ะฒะธัััะฐะปัะฝัั ะฐะดัะตัะพะฒ ะฒ ัะธะทะธัะตัะบะธะต. ะะผะตะฝะฝะพ memory management ะพะฑัััะฝัะตั, ะฟะพัะตะผั fork() ะธัะฟะพะปัะทัะตั Copy-on-Write: ะฒะผะตััะพ ะดัะฑะปะธัะพะฒะฐะฝะธั ะฒัะตั ัััะฐะฝะธั ัะดัะพ ะฟะพะผะตัะฐะตั ะธั read-only ะธ ะบะพะฟะธััะตั ัะพะปัะบะพ ะฟัะธ ะทะฐะฟะธัะธ, ััะพ ะดะตะปะฐะตั fork() ะฟะพััะธ ะผะณะฝะพะฒะตะฝะฝัะผ ะดะปั read-heavy ะฟัะพัะตััะพะฒ. ะะฐะถะดัะน ะฟะพัะพะบ ะฟะพะปััะฐะตั ัะพะฑััะฒะตะฝะฝัะน ััะตะบ (ะพะฑััะฝะพ 8 MB ะฒะธัััะฐะปัะฝะพะน ะฟะฐะผััะธ), ะธ ััะพ ะฝะฐะฟััะผัั ะฒะปะธัะตั ะฝะฐ ะปะธะผะธั ะฟะพัะพะบะพะฒ: 10 000 ะฟะพัะพะบะพะฒ ะฟะพััะตะฑััั 80 GB ะฒะธัััะฐะปัะฝะพะณะพ ะฐะดัะตัะฝะพะณะพ ะฟัะพัััะฐะฝััะฒะฐ. ะะพะฝะธะผะฐะฝะธะต TLB ะธ page table switching ัะฐะบะถะต ะพะฑัััะฝัะตั, ะฟะพัะตะผั ะฟะตัะตะบะปััะตะฝะธะต ะผะตะถะดั ะฟัะพัะตััะฐะผะธ ะดะพัะพะถะต, ัะตะผ ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ.

**[[os-synchronization]]** โ ะกะธะฝััะพะฝะธะทะฐัะธั ัะฒะปัะตััั ะฟััะผัะผ ัะปะตะดััะฒะธะตะผ ะผะฝะพะณะพะฟะพัะพัะฝะพััะธ: ะบะพะณะดะฐ ะฝะตัะบะพะปัะบะพ ะฟะพัะพะบะพะฒ ัะฐะทะดะตะปััั ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ ะฟัะพัะตััะฐ, ะฒะพะทะฝะธะบะฐัั race conditions, ััะตะฑัััะธะต mutex, semaphore ะธ ะดััะณะธั ะฟัะธะผะธัะธะฒะพะฒ. ะะตะท ะบะพััะตะบัะฝะพะน ัะธะฝััะพะฝะธะทะฐัะธะธ ะดะฐะถะต ะฟัะพััะฐั ะพะฟะตัะฐัะธั counter++ ะฟัะตะฒัะฐัะฐะตััั ะฒ data race, ะฟะพัะบะพะปัะบั ัะพััะพะธั ะธะท ัััั ะผะฐัะธะฝะฝัั ะธะฝััััะบัะธะน (load, increment, store), ะผะตะถะดั ะบะพัะพััะผะธ ะผะพะถะตั ะฟัะพะธะทะพะนัะธ ะฟะตัะตะบะปััะตะฝะธะต ะฟะพัะพะบะฐ. ะัะพะฑะปะตะผะฐ deadlock โ ะบะพะณะดะฐ ะดะฒะฐ ะฟะพัะพะบะฐ ะฑะปะพะบะธัััั ะดััะณ ะดััะณะฐ, ะทะฐัะฒะฐัะธะฒ ัะตััััั ะฒ ัะฐะทะฝะพะผ ะฟะพััะดะบะต โ ัะฒะปัะตััั ะพะดะฝะพะน ะธะท ะบะปะฐััะธัะตัะบะธั ะพะฟะฐัะฝะพััะตะน ะผะฝะพะณะพะฟะพัะพัะฝะพะณะพ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั. ะะพะฝะธะผะฐะฝะธะต ะผะพะดะตะปะธ ะฟะฐะผััะธ (memory ordering, happens-before) ะบัะธัะธัะฝะพ ะดะปั ะฝะฐะฟะธัะฐะฝะธั ะบะพััะตะบัะฝะพะณะพ lock-free ะบะพะดะฐ.

**[[jvm-concurrency-overview]]** โ JVM ัะตะฐะปะธะทัะตั ะฟะพัะพะบะธ ะฟะพะฒะตัั ะฝะฐัะธะฒะฝัั OS threads ัะตัะตะท 1:1 ะผะพะดะตะปั: ะบะฐะถะดัะน java.lang.Thread ัะพะพัะฒะตัััะฒัะตั ะพะดะฝะพะผั pthread ะฒ Linux ะธะปะธ NSThread ะฒ macOS. ะญัะพ ะพะทะฝะฐัะฐะตั, ััะพ ะฒัะต ะพะณัะฐะฝะธัะตะฝะธั ะะก โ ััะพะธะผะพััั context switch, ัะฐะทะผะตั ััะตะบะฐ, ะปะธะผะธัั ะฝะฐ ะบะพะปะธัะตััะฒะพ ะฟะพัะพะบะพะฒ โ ะฝะฐะฟััะผัั ะฒะปะธััั ะฝะฐ Java-ะฟัะธะปะพะถะตะฝะธั. ะกะพะทะดะฐะฝะธะต 10 000 Java threads ะฟัะธะฒะพะดะธั ะบ ะฟะพััะตะฑะปะตะฝะธั ~80 GB ะฒะธัััะฐะปัะฝะพะน ะฟะฐะผััะธ (8 MB ััะตะบ ร 10K) ะธ ัััััะฐะผ context switches ะฒ ัะตะบัะฝะดั. JVM ะดะพะฑะฐะฒะปัะตั ัะพะฑััะฒะตะฝะฝัะน overhead: safepoint polling, GC stop-the-world ะฟะฐัะทั ะฑะปะพะบะธัััั ะฒัะต ะฟะพัะพะบะธ, ะฐ synchronized/volatile ัะตะฐะปะธะทััััั ัะตัะตะท CAS-ะธะฝััััะบัะธะธ ะธ memory barriers ะฟัะพัะตััะพัะฐ. ะัะพะตะบั Loom (virtual threads) ะฒ Java 21+ ะฟะตัะตัะพะดะธั ะบ ะผะพะดะตะปะธ M:N, ะฐะฝะฐะปะพะณะธัะฝะพะน ะบะพัััะธะฝะฐะผ.

**[[kotlin-coroutines]]** โ ะะพัััะธะฝั Kotlin ัะตะฐะปะธะทััั M:N ะผะพะดะตะปั ะฟะพัะพะบะพะฒ: ะผะฝะพะถะตััะฒะพ ะปะตะณะบะพะฒะตัะฝัั ะบะพัััะธะฝ ะผัะปััะธะฟะปะตะบัะธัััััั ะฝะฐ ะฝะตะฑะพะปััะพะน ะฟัะป OS threads ัะตัะตะท Dispatchers. ะ ะพัะปะธัะธะต ะพั OS threads, ะบะพัััะธะฝะฐ ะฝะต ะฟัะธะฒัะทะฐะฝะฐ ะบ ะบะพะฝะบัะตัะฝะพะผั ะฟะพัะพะบั ะธ ะผะพะถะตั ะฟัะธะพััะฐะฝะพะฒะธัััั (suspend) ะฑะตะท ะฑะปะพะบะธัะพะฒะบะธ ะฝะธะถะตะปะตะถะฐัะตะณะพ ะฟะพัะพะบะฐ โ ะฒะผะตััะพ ะฑะปะพะบะธััััะตะณะพ ัะธััะตะผะฝะพะณะพ ะฒัะทะพะฒะฐ ะพะฝะฐ ัะพััะฐะฝัะตั continuation ะธ ะพัะฒะพะฑะพะถะดะฐะตั ะฟะพัะพะบ ะดะปั ะดััะณะพะน ัะฐะฑะพัั. ะญัะพ ัะตัะฐะตั ะฟัะพะฑะปะตะผั ะผะฐัััะฐะฑะธััะตะผะพััะธ: ะตัะปะธ 10 000 OS threads ะฟะพััะตะฑะปััั 80 GB ะฟะฐะผััะธ ะธ ะณะตะฝะตัะธัััั ัััััะธ context switches, ัะพ 10 000 ะบะพัััะธะฝ ัะฐะฑะพัะฐัั ะฝะฐ ะฟัะปะต ะธะท 4-8 ะฟะพัะพะบะพะฒ ั ะผะธะฝะธะผะฐะปัะฝัะผ overhead (~200 bytes ะฝะฐ ะบะพัััะธะฝั). ะะพะฝะธะผะฐะฝะธะต OS threads ะฝะตะพะฑัะพะดะธะผะพ ะดะปั ะพัะปะฐะดะบะธ ะบะพัััะธะฝ: structured concurrency, dispatchers ะธ ะธั ะฒะทะฐะธะผะพะดะตะนััะฒะธะต ั ะะก ะพะฟัะตะดะตะปััั ัะตะฐะปัะฝัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั.

---

## ะะตะบะพะผะตะฝะดัะตะผัะต ะธััะพัะฝะธะบะธ

### ะัะธัะธะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั
- [fork(2) - Linux manual page](https://man7.org/linux/man-pages/man2/fork.2.html) โ ะพัะธัะธะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั fork
- [pthreads(7) - Linux manual page](https://man7.org/linux/man-pages/man7/pthreads.7.html) โ POSIX threads

### ะฃัะตะฑะฝะธะบะธ

- Tanenbaum A., Bos H. (2014). *"Modern Operating Systems, 4th Edition."* โ ะณะปะฐะฒั 2 (Processes and Threads) ะธ 11 (Case Study: Linux) ะดะฐัั ะฟะพะปะฝัั ะบะฐััะธะฝั ะพั ะฐะฑัััะฐะบัะธะธ ะฟัะพัะตััะฐ ะดะพ ัะตะฐะปะธะทะฐัะธะธ ะฒ Linux; ะบะปะฐััะธัะตัะบะพะต ะธะทะปะพะถะตะฝะธะต ั ะฟัะธะผะตัะฐะผะธ MINIX.
- Silberschatz A., Galvin P., Gagne G. (2018). *"Operating System Concepts, 10th Edition."* โ ะณะปะฐะฒั 3 (Processes) ะธ 4 (Threads & Concurrency) ะดะตัะฐะปัะฝะพ ัะฐะทะฑะธัะฐัั ะผะพะดะตะปะธ ะฟะพัะพะบะพะฒ (1:1, M:N, M:1) ะธ IPC-ะผะตัะฐะฝะธะทะผั; ัะพัะพั ะดะปั ะฟะพะดะณะพัะพะฒะบะธ ะบ ัะบะทะฐะผะตะฝะฐะผ ะธ ะธะฝัะตัะฒัั.
- Arpaci-Dusseau R., Arpaci-Dusseau A. (2018). *"Operating Systems: Three Easy Pieces."* โ ะณะปะฐะฒั 4-6 (Processes, API, Limited Direct Execution) ะธ 26-33 (Concurrency) โ ะฑะตัะฟะปะฐัะฝะฐั ะบะฝะธะณะฐ ั ะพัะปะธัะฝัะผะธ ะฐะฝะฐะปะพะณะธัะผะธ ะธ ะฟัะฐะบัะธัะตัะบะธะผะธ ัะฟัะฐะถะฝะตะฝะธัะผะธ.
- Bryant R., O'Hallaron D. (2015). *"Computer Systems: A Programmer's Perspective, 3rd Edition."* โ ะณะปะฐะฒั 8 (Exceptional Control Flow) ะธ 12 (Concurrent Programming) ัะฐััะผะฐััะธะฒะฐัั ะฟัะพัะตััั ะธ ะฟะพัะพะบะธ ั ัะพัะบะธ ะทัะตะฝะธั ะฟัะพะณัะฐะผะผะธััะฐ, ะฒะบะปััะฐั signal handling ะธ thread safety.
- Love R. (2010). *"Linux Kernel Development, 3rd Edition."* โ ะณะปะฐะฒั 3 (Process Management) ะธ 4 (Process Scheduling) ะพะฟะธััะฒะฐัั ัะตะฐะปะธะทะฐัะธั task_struct, fork(), clone() ะธ CFS ะฝะฐ ััะพะฒะฝะต ะธััะพะดะฝะพะณะพ ะบะพะดะฐ ัะดัะฐ Linux.

### ะะฝะธะณะธ ะธ ะบัััั
- [OSTEP: Concurrency chapters](https://pages.cs.wisc.edu/~remzi/OSTEP/) โ ะฑะตัะฟะปะฐัะฝะฐั ะบะฝะธะณะฐ, ะณะปะฐะฒั 26-33 ะพ ะฟะพัะพะบะฐั
- [MIT 6.S081 Lab: Threading](https://pdos.csail.mit.edu/6.1810/2025/) โ ะฟัะฐะบัะธัะตัะบะฐั ะปะฐะฑะฐ ะฟะพ ะฟะพัะพะบะฐะผ ะฒ xv6

### ะกัะฐััะธ ะธ ัััะพัะธะฐะปั
- [SoftPrayog: fork and exec in Linux](https://www.softprayog.in/programming/creating-processes-with-fork-and-exec-in-linux) โ ะดะตัะฐะปัะฝัะน ัััะพัะธะฐะป ั ะฟัะธะผะตัะฐะผะธ
- [GeeksforGeeks: Process vs Thread](https://www.geeksforgeeks.org/operating-systems/difference-between-process-and-thread/) โ ััะฐะฒะฝะตะฝะธะต ั ะฟัะธะผะตัะฐะผะธ
- [PlanetScale: Processes and Threads](https://planetscale.com/blog/processes-and-threads) โ ะพัะปะธัะฝะพะต ะพะฑัััะฝะตะฝะธะต ะฝะฐ ะฟัะธะผะตัะต PostgreSQL ะธ MySQL

### ะะปัะฑะพะบะพะต ะฟะพะณััะถะตะฝะธะต
- [Eli Bendersky: Measuring context switching overhead](https://eli.thegreenplace.net/2018/measuring-context-switching-and-memory-overheads-for-linux-threads/) โ ะฑะตะฝัะผะฐัะบะธ ั ะบะพะดะพะผ
- [How browsers use processes and threads](https://sunandakarunajeewa.medium.com/how-web-browsers-use-processes-and-threads-5ddbea938b1c) โ Chrome vs Firefox ะฐััะธัะตะบัััะฐ

---

*ะะฑะฝะพะฒะปะตะฝะพ: 2026-01-09 โ ะดะพะฑะฐะฒะปะตะฝั ะฟะตะดะฐะณะพะณะธัะตัะบะธะต ัะตะบัะธะธ (5 ะฐะฝะฐะปะพะณะธะน: ะบะฒะฐััะธัั/ะถะธะปััั, fork ะบะฐะบ ะบะปะพะฝะธัะพะฒะฐะฝะธะต, exec ะบะฐะบ ััะฐะฝััะพัะผะฐัะธั, context switch ะบะฐะบ ัะฐะทะณะพะฒะพัั, ะผะพะดะตะปะธ ะฟะพัะพะบะพะฒ ะบะฐะบ ัะฐะบัะธ; 6 ัะธะฟะธัะฝัั ะพัะธะฑะพะบ ั ะกะะะะขะะ/ะะะจะะะะ; 5 ะผะตะฝัะฐะปัะฝัั ะผะพะดะตะปะตะน: ะบะพะฝัะตะนะฝะตั/ะธัะฟะพะปะฝะธัะตะปั, ะถะธะทะฝะตะฝะฝัะน ัะธะบะป FSM, fork+exec, ัะฐะฑะปะธัะฐ ะฒัะฑะพัะฐ, ะฟะธัะฐะผะธะดะฐ ััะพะธะผะพััะธ)*

---

## ะัะพะฒะตัั ัะตะฑั

> [!question]- ะะพัะตะผั PostgreSQL ะธัะฟะพะปัะทัะตั ะผะพะดะตะปั process-per-connection, ะฐ MySQL โ thread-per-connection, ะธ ะฒ ะบะฐะบะธั ััะตะฝะฐัะธัั ะบะฐะถะดัะน ะฟะพะดัะพะด ะฒัะธะณััะฒะฐะตั?
> PostgreSQL ะฒัะฑัะฐะป ะฟัะพัะตััั ัะฐะดะธ ะธะทะพะปััะธะธ: ะฟะฐะดะตะฝะธะต ะพะดะฝะพะณะพ ัะพะตะดะธะฝะตะฝะธั ะฝะต ะผะพะถะตั ะฟะพะฒัะตะดะธัั ะพะฑััั ะฟะฐะผััั ะดััะณะพะณะพ. MySQL ะฒัะฑัะฐะป ะฟะพัะพะบะธ ัะฐะดะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ: ะผะตะฝััะต overhead ะฝะฐ ัะพะทะดะฐะฝะธะต ะธ ะฟะตัะตะบะปััะตะฝะธะต, ะพะฑัะธะน ะบัั ะทะฐะฟัะพัะพะฒ. PostgreSQL ะฒัะธะณััะฒะฐะตั ะฒ ะฝะฐะดัะถะฝะพััะธ (ะดะปะธะฝะฝัะต ััะฐะฝะทะฐะบัะธะธ, ัะฐััะธัะตะฝะธั ะฝะฐ C), MySQL โ ะฒ throughput ะฟัะธ ัััััะฐั ะบะพัะพัะบะธั ัะพะตะดะธะฝะตะฝะธะน. ะะพััะพะผั PostgreSQL ะฝัะถะดะฐะตััั ะฒ connection pooling (PgBouncer) ัะฐะฝััะต, ัะตะผ MySQL.

> [!question]- ะัะธ ะบะฐะบะธั ััะปะพะฒะธัั M:N ะผะพะดะตะปั ะฟะพัะพะบะพะฒ (goroutines, coroutines) ะดะตะณัะฐะดะธััะตั ะดะพ ััะพะฒะฝั ะพะฑััะฝัั OS threads, ะธ ะบะฐะบ ััะพะณะพ ะธะทะฑะตะถะฐัั?
> M:N ะดะตะณัะฐะดะธััะตั, ะบะพะณะดะฐ goroutines ะฒัะฟะพะปะฝััั ะฑะปะพะบะธััััะธะต syscalls ะธะปะธ CGO-ะฒัะทะพะฒั: ะบะฐะถะดัะน ัะฐะบะพะน ะฒัะทะพะฒ ะฑะปะพะบะธััะตั ัะตะปัะน OS thread ะธะท ะฟัะปะฐ, ะธ ะฟัะธ ะดะพััะฐัะพัะฝะพะผ ะบะพะปะธัะตััะฒะต ะฑะปะพะบะธััััะธั ะฒัะทะพะฒะพะฒ ะฒัะต OS threads ะทะฐะฝััั โ ะฟะปะฐะฝะธัะพะฒัะธะบ ะฝะต ะผะพะถะตั ะทะฐะฟััะบะฐัั ะดััะณะธะต goroutines. ะะทะฑะตะถะฐัั ะผะพะถะฝะพ ัะตัะตะท ะฝะตะฑะปะพะบะธััััะธะต API, worker pool ะดะปั ะฑะปะพะบะธััััะธั ะพะฟะตัะฐัะธะน ะธ ัะฒะตะปะธัะตะฝะธะต GOMAXPROCS ะดะปั CGO-heavy ะบะพะดะฐ.

> [!question]- ะกัะฐะฒะฝะธัะต ััะพะธะผะพััั context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ ะธ ะผะตะถะดั ะฟัะพัะตััะฐะผะธ. ะะพัะตะผั ัะฐะทะฝะธัะฐ ะฝะต ะฒ 10 ัะฐะท, ะฐ ะฒัะตะณะพ ะฒ ~2 ัะฐะทะฐ?
> ะัะฝะพะฒะฝะฐั ัะฐะทะฝะธัะฐ โ TLB flush ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะฟัะพัะตััะพะฒ (ัะผะตะฝะฐ CR3 ัะตะณะธัััะฐ). ะะพ ะฑะปะฐะณะพะดะฐัั PCID (Process Context ID) ะฝะฐ ัะพะฒัะตะผะตะฝะฝัั CPU ะฟะพะปะฝัะน TLB flush ะฝะต ะฝัะถะตะฝ โ ะทะฐะฟะธัะธ ัะตะณะธัััััั. ะะพััะพะผั ัะตะฐะปัะฝะฐั ัะฐะทะฝะธัะฐ ~1.2-1.5ยตs vs ~2.2ยตs. ะัะฝะพะฒะฝะพะน ัะบััััะน cost ะฝะต ะฒ ัะฐะผะพะผ switch, ะฐ ะฒ ะฟะพัะปะตะดัััะธั TLB miss ะธ cache miss ะฟัะธ "ะฟัะพะณัะตะฒะต" ะบััะตะน ะฝะพะฒะพะณะพ ะฟัะพัะตััะฐ.

> [!question]- ะะพัะตะผั zombie ะฟัะพัะตััั ะพะฟะฐัะฝะตะต ะฝะฐ ะฟัะฐะบัะธะบะต, ัะตะผ orphan ะฟัะพัะตััั, ัะพัั zombie ะฝะต ะฟะพััะตะฑะปััั ะฝะธ CPU, ะฝะธ ะฟะฐะผััั?
> Zombie ะทะฐะฝะธะผะฐัั ะทะฐะฟะธัั ะฒ ัะฐะฑะปะธัะต ะฟัะพัะตััะพะฒ ัะดัะฐ, ะบะพัะพัะฐั ะบะพะฝะตัะฝะฐ (ะพะฑััะฝะพ 32768 ะฟะพ ัะผะพะปัะฐะฝะธั). ะัะปะธ ะฟัะพะณัะฐะผะผะฐ ะฟะพัะพะถะดะฐะตั ัััััะธ ะดะพัะตัะฝะธั ะฟัะพัะตััะพะฒ ะฑะตะท wait() โ PID ะฟัะพัััะฐะฝััะฒะพ ะธััะตัะฟะฐะตััั, ะธ ัะธััะตะผะฐ ะฝะต ัะผะพะถะตั ัะพะทะดะฐะฒะฐัั ะฝะพะฒัะต ะฟัะพัะตััั. Orphan ะฟัะพัะตััั ะฑะตะทะพะฟะฐัะฝั โ init (PID 1) ะฐะฒัะพะผะฐัะธัะตัะบะธ "ัััะฝะพะฒะปัะตั" ะธั ะธ ะฒัะทัะฒะฐะตั wait() ะฟัะธ ะทะฐะฒะตััะตะฝะธะธ.

---

## ะะปััะตะฒัะต ะบะฐััะพัะบะธ

ะงะตะผ ะฟะพัะพะบ ะพัะปะธัะฐะตััั ะพั ะฟัะพัะตััะฐ?
?
ะะพัะพะบ โ ะตะดะธะฝะธัะฐ ะฒัะฟะพะปะฝะตะฝะธั ะฒะฝัััะธ ะฟัะพัะตััะฐ, ัะฐะทะดะตะปัััะฐั heap ะธ ัะตััััั ั ะดััะณะธะผะธ ะฟะพัะพะบะฐะผะธ. ะัะพัะตัั โ ะธะทะพะปะธัะพะฒะฐะฝะฝะฐั ะฟัะพะณัะฐะผะผะฐ ั ัะพะฑััะฒะตะฝะฝัะผ ะฐะดัะตัะฝัะผ ะฟัะพัััะฐะฝััะฒะพะผ. ะะพัะพะบะธ ะดะตัะตะฒะปะต (~50ยตs ัะพะทะดะฐะฝะธะต, ~2MB stack), ะฝะพ ะพะดะธะฝ ัะฟะฐะฒัะธะน ะฟะพัะพะบ ัะพะฝัะตั ะฒะตัั ะฟัะพัะตัั.

ะงัะพ ะดะตะปะฐะตั fork() ะฒ Unix?
?
fork() ัะพะทะดะฐัั ัะพัะฝัั ะบะพะฟะธั ะฟัะพัะตััะฐ ัะตัะตะท ัะธััะตะผะฝัะน ะฒัะทะพะฒ clone(). ะัะฟะพะปัะทัะตั Copy-on-Write โ ัะตะฐะปัะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต ัััะฐะฝะธั ะฟะฐะผััะธ ะฟัะพะธััะพะดะธั ัะพะปัะบะพ ะฟัะธ ะทะฐะฟะธัะธ. ะะพะดะธัะตะปั ะฟะพะปััะฐะตั PID ัะตะฑัะฝะบะฐ, ัะตะฑัะฝะพะบ ะฟะพะปััะฐะตั 0.

ะงัะพ ัะฐะบะพะต Copy-on-Write (COW)?
?
ะะฟัะธะผะธะทะฐัะธั fork(): ะฒะผะตััะพ ะบะพะฟะธัะพะฒะฐะฝะธั ะฟะฐะผััะธ ะพะฑะต ะบะพะฟะธะธ ัะฐะทะดะตะปััั ะพะดะฝะธ ัััะฐะฝะธัั (ะฟะพะผะตัะตะฝั read-only). ะัะธ ะฟะพะฟััะบะต ะทะฐะฟะธัะธ ะฟัะพะธััะพะดะธั page fault, ะธ ัะดัะพ ะบะพะฟะธััะตั ัะพะปัะบะพ ะธะทะผะตะฝัะฝะฝัั ัััะฐะฝะธัั. ะญะบะพะฝะพะผะธั ะฒัะตะผั ะธ ะฟะฐะผััั.

ะงะตะผ ะผะพะดะตะปั 1:1 ะพัะปะธัะฐะตััั ะพั M:N ะดะปั ะฟะพัะพะบะพะฒ?
?
1:1 (Linux pthreads): ะพะดะธะฝ user thread = ะพะดะธะฝ kernel thread. ะะฐะดัะถะฝะพ, ะฝะพ ะดะพัะพะณะพ (~8MB stack). M:N (Go goroutines, Kotlin coroutines): ะผะฝะพะณะพ user threads ะฝะฐ ะฝะตัะบะพะปัะบะพ kernel threads. ะััะตะฒะพ (~2-8KB), ะผะฐัััะฐะฑะธััะตััั ะดะพ ะผะธะปะปะธะพะฝะพะฒ, ะฝะพ ะฑะปะพะบะธััััะธะน syscall ะฑะปะพะบะธััะตั ะฒะตัั OS thread.

ะงัะพ ัะฐะบะพะต zombie ะฟัะพัะตัั ะธ ะบะฐะบ ะตะณะพ ะฟัะตะดะพัะฒัะฐัะธัั?
?
Zombie โ ะทะฐะฒะตัััะฝะฝัะน ะฟัะพัะตัั, ัะตะน ัะพะดะธัะตะปั ะฝะต ะฒัะทะฒะฐะป wait(). ะะฐะฝะธะผะฐะตั ะทะฐะฟะธัั ะฒ ัะฐะฑะปะธัะต ะฟัะพัะตััะพะฒ. ะัะตะดะพัะฒัะฐัะตะฝะธะต: ะฒัะทัะฒะฐัั wait()/waitpid(), ัััะฐะฝะพะฒะธัั signal(SIGCHLD, SIG_IGN), ะธะปะธ ะธัะฟะพะปัะทะพะฒะฐัั ะดะฒะพะนะฝะพะน fork.

ะะพัะตะผั context switch ะผะตะถะดั ะฟะพัะพะบะฐะผะธ ะฑััััะตะต, ัะตะผ ะผะตะถะดั ะฟัะพัะตััะฐะผะธ?
?
ะัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะผะตะถะดั ะฟัะพัะตััะฐะผะธ ะฝัะถะฝะพ ัะผะตะฝะธัั page table (CR3), ัะฑัะพัะธัั TLB ะธ ะฟัะพะณัะตัั ะบััะธ. ะะตะถะดั ะฟะพัะพะบะฐะผะธ ะพะดะฝะพะณะพ ะฟัะพัะตััะฐ ะฐะดัะตัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ ะพะฑัะตะต โ TLB ะพััะฐัััั ะฒะฐะปะธะดะฝัะผ. ะะฐะทะฝะธัะฐ: ~1.2-1.5ยตs (ะฟะพัะพะบะธ) vs ~2.2+ยตs (ะฟัะพัะตััั).

ะะพะณะดะฐ ะปัััะต ะธัะฟะพะปัะทะพะฒะฐัั ะฟัะพัะตััั ะฒะผะตััะพ ะฟะพัะพะบะพะฒ?
?
ะัะพัะตััั ะฝัะถะฝั ะดะปั ะธะทะพะปััะธะธ ะธ ะฑะตะทะพะฟะฐัะฝะพััะธ: sandbox ะดะปั ะฝะตะดะพะฒะตัะตะฝะฝะพะณะพ ะบะพะดะฐ, ะพัะดะตะปัะฝัะต ะฒะบะปะฐะดะบะธ ะฒ Chrome, ะผะธะบัะพัะตัะฒะธัั ะฝะฐ ัะฐะทะฝัั ัะทัะบะฐั. ะะพัะพะบะธ โ ะบะพะณะดะฐ ะฝัะถะฝะฐ ะพะฑัะฐั ะฟะฐะผััั, ะฒััะพะบะฐั ัะบะพัะพััั ัะพะทะดะฐะฝะธั ะธ ะฝะธะทะบะฐั latency context switch.

ะะฐะบะพะน overhead ั goroutine ะฟะพ ััะฐะฒะฝะตะฝะธั ั OS thread?
?
Goroutine: ~2-8KB ะฟะฐะผััะธ, ~0.3ยตs ัะพะทะดะฐะฝะธะต. OS thread: ~1-8MB stack, ~30-50ยตs ัะพะทะดะฐะฝะธะต. ะะฐะทะฝะธัะฐ ะฒ 1000x ะฟะพ ะฟะฐะผััะธ ะธ 100x ะฟะพ ัะบะพัะพััะธ ัะพะทะดะฐะฝะธั. ะญัะพ ะฟะพะทะฒะพะปัะตั ะทะฐะฟััะบะฐัั ะผะธะปะปะธะพะฝ ะณะพัััะธะฝ vs ~10K OS threads.

---

## ะัะดะฐ ะดะฐะปััะต

| ะะฐะฟัะฐะฒะปะตะฝะธะต | ะัะดะฐ | ะะฐัะตะผ |
|-------------|------|-------|
| ะกะปะตะดัััะธะน ัะฐะณ | [[os-scheduling]] | ะะฐะบ ะฟะปะฐะฝะธัะพะฒัะธะบ ัะตัะฐะตั, ะบะฐะบะพะน ะฟะพัะพะบ ะฟะพะปััะธั CPU |
| ะกะปะตะดัััะธะน ัะฐะณ | [[os-synchronization]] | Mutex, semaphore โ ัะตัะตะฝะธะต ะฟัะพะฑะปะตะผ ะพะฑัะตะน ะฟะฐะผััะธ ะฟะพัะพะบะพะฒ |
| ะฃะณะปัะฑะธัััั | [[os-memory-management]] | ะะธัััะฐะปัะฝะฐั ะฟะฐะผััั, paging, COW โ ะผะตัะฐะฝะธะบะฐ ะฟะพะด ะบะฐะฟะพัะพะผ fork() |
| ะกะผะตะถะฝะฐั ัะตะผะฐ | [[kotlin-coroutines]] | M:N ะผะพะดะตะปั ะฒ Kotlin โ ะฟัะฐะบัะธัะตัะบะฐั ัะตะฐะปะธะทะฐัะธั green threads |
| ะกะผะตะถะฝะฐั ัะตะผะฐ | [[jvm-concurrency-overview]] | ะะฐะบ JVM ัะตะฐะปะธะทัะตั ะฟะพัะพะบะธ ะฟะพะฒะตัั OS threads |
| ะะฑะทะพั | [[os-overview]] | ะะตัะฝััััั ะบ ะบะฐััะต ัะฐะทะดะตะปะฐ Operating Systems |

---

*ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 2026-02-14*

---

*ะัะพะฒะตัะตะฝะพ: 2026-02-14*
